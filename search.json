[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Ecological theory for the biodiversity crisis",
    "section": "",
    "text": "Welcome\nThis is the website for “Ecological theory for the biodiversity crisis” book. This book teaches ecological theory with a hands-on approach using the R language. The ecological theory topics are often presented with an emphasis on their relevance for biodiversity conservation and management.\nThis book was created with the Quarto publishing system.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Ecological theory for the biodiversity crisis",
    "section": "License",
    "text": "License\nThis website is (and will always be) free to use, and is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 4.0 License.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "Ecological theory for the biodiversity crisis",
    "section": "",
    "text": "An R package is a set of functions developed by someone to extend the basic functionality of R.↩︎\nFor a guide on best practices for reproducible code see https://www.britishecologicalsociety.org/wp-content/uploads/2019/06/BES-Guide-Reproducible-Code-2019.pdf↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "ecophysiology.html",
    "href": "ecophysiology.html",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "",
    "text": "1.1 A model for the body temperature of an animal\nAnimals can be divided in two big groups in regard to the way they regulate their temperature: ecoctherms and endotherms (Figure 1.1). Endotherms such as mammals and birds are able to regulate their temperature by producing heat through metabolism. Ectotherms in contrast must regulate their temperature by obtaining heat from the environment. By obtaining energy from the environment, ectotherms have lower energy demands than endotherms, which have to be burning energy all the time to keep their bodies warm. Both do have to avoid getting too hot because indeed there can bee too much from a good thing.\nTo build a model of the body temperature of an animal, let’s consider a lizard that is perched in a rock basking in the sun (Figure 1.2). The lizard receives heat from the direct solar radiation than can be measured in for instance calories per hour. It can also receive indirect solar radiation, reflected for instance by the ground. The lizard also exchanges heat with the surrounding air through convection. If the lizard body temperature is higher than the surrounding air temperature it will lose heat, while if the lizard body temperature is lower than it will gain heat. The rate at which this exchange of heat through convection happens depends on the body of the animal and the properties of its skin. These properties are captured in the heat transfer coefficient, which can be measured as calories per hour per degree Celsius. Similarly, the lizard can receive heat by conduction from being in contact with a warm rock, or lose heat to the rock if the rock is colder than the lizard’s body temperature. Finally the animal can lose heat through evapotranspiration, this is by transpiring water that has a cooling effect when it evaporates. I also like to think about this model as representing our own experience on the beach. We can be laying on a towel receiving heat by conduction from the sand and solar radiation from the sun. If the air temperature is warm, we can become uncomfortable in the sun and we may seek a shade to reduce the input from solar radiation, but if there is a cool brise we may be able to stay in the sun a bit longer. If the air temperature is really cold and it’s really windy our skin hair may rise to reduce the convection coefficient.\nThe total flow of energy into the lizard, also known as the heat exchange equation, can be written as \\[f=q-k(b-a) \\tag{1.1}\\]\nwhere\nIf the energy flow is positive, then the lizard is warming, while if it is negative then the lizard is cooling. The equilibrium1 happens when the energy flow is zero and so the the lizard is neither cooling nor warming. If we solve Equation 1.1 for equilibrium by replacing \\(f\\) with zero and expanding the right-hand side of the equation,\n\\[\n0=q-k\\ b+k\\ a\n\\]\nand rearranging for \\(b\\) we find the equilibrium body temperature that we denote with a hat,\n\\[\n\\hat{b}=q/k+a.\n\\tag{1.2}\\]\nLet’s see if this equation makes sense. It says that the equilibrium body temperature is the sum of the solar radiation divided by the convection coefficient with the air temperature. So, at minimum the equilibrium body temperature is equal to the air temperature when the solar radiation is zero (e.g. during the night). But when the solar radiation is greater than zero then the equilibrium body temperature is higher than the air temperature as one would expect. How much higher? Well that depends on the convection coefficient. If the convection coefficient is very high then the body temperature is mainly determined by the air temperature. In contrast, if the convection coefficient is very low then the solar radiation can contribute significantly to the body temperature.\nIt’s time to start using R to explore this model. For instance, we can use R to plot the relationship between the body temperature and the solar radiation. First we create variables for the heat coefficient and the air temperature and assign some valuues:\nk = 50  #convection coefficient (cal/h/ºC)\na = 18  #air temperature (ºC)\nWe want to plot the equilibrium body temperature for a range of solar radiation values. So we create a vector with radiation values, for instance ranging from 0 cal/h to 1500 cal/h in steps of 500. I am going to use big letters to denote vectors in R code, in contrast with scalars which I will denote with small letters.\nQ = seq(0,1500,by=500)  #vector with radiation values\nNow we can write Equation 1.2 in R to produce a vector of the equilibrium body temperatures for each value of radiation.\nB_eq = Q/k+a   #vector with equilibrium body temperatures\nLet’s examine the values of the vector, by binding the two vectors as a matrix,\nrbind(Q,B_eq)\n\n     [,1] [,2] [,3] [,4]\nQ       0  500 1000 1500\nB_eq   18   28   38   48\nThis is nice as we can see the values of the equilibrium body temperature for each value of solar radiation. But let’s visualize this as a graph, by plotting these vectors in R,\nplot(Q,B_eq,type=\"l\")\n\n\n\n\n\n\n\nFigure 1.3: Equilibrium body temperature as a function of solar radiation.\nNote that we added type=\"l\" as a parameter of the plot to have a line drawn instead of a sequence of dots in the plot.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "ecophysiology.html#a-model-for-the-body-temperature-of-an-animal",
    "href": "ecophysiology.html#a-model-for-the-body-temperature-of-an-animal",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "",
    "text": "Figure 1.1: Shrews (left, Crocidura russula) are ectotherms and have high energy demands, eating almost their body weight every day. In contrast, vipers (right, Vipera seonae) can go days without eating, or even hibernate or aestivate as needed.\n\n\n\n\n\n\n\n\n\n\nFigure 1.2: The energy flows of a lizard basking in the sun.\n\n\n\n\n\n\n\\(f\\) is the energy flow (cal/h),\n\\(q\\) is the quantity of heat in the solar radiation (cal/h),\n\\(k\\) is the convection coefficient (cal/h/ºC),\n\\(b\\) is the body temperature (ºC) and\n\\(a\\) is the air temperature (ºC).",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "ecophysiology.html#understanding-the-climate-space",
    "href": "ecophysiology.html#understanding-the-climate-space",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "1.2 Understanding the climate space",
    "text": "1.2 Understanding the climate space\nAnother way of looking at the heat exchange equation Equation 1.1 is to look at what combinations of air temperature and solar radiation values are livable for the lizard. This is also known as the climate space of an organism. In order to explore the climate space of the lizard we need to first assess what are the maximum and minimum body temperature that the lizard can experience. Let’s assume those are respectively 36 and 24ºC and store them in R,\n\nb_max = 36  #maximum body temperature (ºC)\nb_min = 24  #minimum body temperature (ºC)\n\nWe now want to solve Equation 1.1 at equilibrium for the air temperature as a function of the solar radiation and body temperature. We can do this by rearranging Equation 1.2,\n\\[\na=b-q/k.\n\\tag{1.3}\\]\nThis equation can be then used in R to calculate vectors of the maximum and minimum survivable air temperatures for each value of the solar radiation in vector Q,\n\nA_max = b_max - Q/k  #vector with maximum air temperatures\nA_min = b_min - Q/k  #vector with minimum air temperatures\n\nWe can now visualize the climate space, this is, the combination of solar radiation and air temperatures in which the lizard can survive, by plotting these two equations (i.e. by plotting lines with x coordinates given by the vector Q and the y coordinates given by the vectors A_max and A_min),\n\nplot(Q, A_max,type=\"l\", #plots the maximum survivable air temperature\n     xlab=\"Solar radiation (cal/h)\", #adds x and y axis labels to the plot\n     ylab=\"Air temperature (ºC)\")    \nlines(Q,A_min) #adds line for the minimum survivable air temperature\n\n\n\n\n\n\n\nFigure 1.4: The climate space of a lizard.\n\n\n\n\n\nLet’s paint the area between the two lines which corresponds to the climate space of the lizard. We can use the R function polygon, to which we need to give the set of x and y coordinates delimiting the climate space as vectors. For instance, the upper lower corner can be the first coordinate, being 0 for the x vector and b_min for the y vector. The right upper corner is 1500 for x and b_max-1500/k for y.\n\nX = c(0,0,1500,1500)\nY = c(b_min,b_max,b_max-1500/k,b_min-1500/k)\npolygon(X,Y,col=\"green\")\n\nNow that we have the climate space we can plot on top of it some empirical data of how the conditions are in the field during the day. We can for instance consider two micro-habitats, a rock (in the sun) and a bush (in the shade). Suppose we obtain some data from temperature loggers that were installed in each micro-habitat , recording every three hours the values of temperature and radiation as tabled below.\n\n\n\nTable 1.1: Hypothetical radiation values in two micro-habitats and air temperatures at different times of the day.\n\n\n\n\n\n\n\n\n\n\n\nTime (hh:mm)\nRadiation rock (cal/h)\nRadiation bush (cal/h)\nTemperature (ºC)\n\n\n\n\n00:00\n150\n150\n18\n\n\n03:00\n150\n150\n13\n\n\n06:00\n800\n450\n10\n\n\n09:00\n1100\n600\n14\n\n\n12:00\n1300\n650\n21\n\n\n15:00\n1200\n650\n24\n\n\n18:00\n800\n350\n22\n\n\n21:00\n400\n200\n20\n\n\n\n\n\n\nWe can overlay these values of temperatures and radiations on the plot to understand which microhabitat should the lizard choose at each time of the day. First we create a vector for each column of Table 1.1. Note that we must enclose the times of the day in commas as they are strings. We also append at the end of the vector the values for 0:00 in order to close the lines (otherwise there would be a gap between 21:00 and 0:00).\n\n#Times of the day\nT = c(\"00:00\",\"03:00\",\"06:00\",\"09:00\",\n      \"12:00\",\"15:00\",\"18:00\",\"21:00\",\"00:00\")\n\n#Solar radiation in the rock habitat\nRock_q = c(150,150,800,1100,1300,1200,800,400,150)\n\n#Air temperature in the rock habitat\nRock_a = c(18,13,10,14,21,24,22,20,18)\n\n#Solar radiation in the bush habitat\nBush_q = c(150,150,450,600,650,650,350,200,150)\n\n#   Air temperature in the bush habitat\nBush_a = c(18,13,10,14,21,24,22,20,18)\n\nWe overlay these vectors in the figure by invoking the function lines(Xcoor,Ycoord) for each micro-habitat. We add labels to each point to show the correspondence between each point and the time of the day.\n\nlines(Rock_q,Rock_a,col=\"orange\")\ntext(Rock_q,Rock_a,T)\n\nlines(Bush_q,Bush_a,col=\"blue\")\ntext(Bush_q,Bush_a,T)\n\n\n\n\n\n\n\n\n\nFigure 1.5: The climate space of a lizard with the conditions of two microhabitats ploted at different times of the day: rock (orange), bush (blue).",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "ecophysiology.html#from-ecophysiological-models-to-species-distribution-models",
    "href": "ecophysiology.html#from-ecophysiological-models-to-species-distribution-models",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "1.3 From ecophysiological models to species distribution models",
    "text": "1.3 From ecophysiological models to species distribution models\nIn the previous section we developed a simple mechanistic model for the climate space of an organism. This is a micro-habitat level climate space. But one can also infer the climate space from the distribution of a species at the macro-habitat level. They are different but they are conceptually similar. The inference of such macro climate space is an area where species distribution models excel (for more on species distribution models check for example (Guisan, Thuiller, and Zimmermann 2017)). The idea is relatively simple. One starts with a bunch of locations of a species in geographical space. Then, one obtains the climate characteristics for those locations, and then plots those locations in climate space. The convex hull in climate space delimited by those locations is the macro-habitat climate space. What species distribution models (SDMs) learn to do is to delineate that climate space, this is, SDMs try to predict the probability of a species occurring somewhere in the climate space by learning from presences and absences from species. Then the SDM can extrapolate again what happens in geographical space, by predicting the species occurence probability for any point based on the climate data for that point. Without getting all the way into a full blown SDM, let’s try to follow some of the basics.\n\n\n\n\n\n\nFigure 1.6: The Iberian emerald lizard, Lacerta schreiberi.\n\n\n\nI will illustrate this with one my favorite species, the Iberian emerald lizard, Lacerta schreiberi, a species endemic to the Iberian peninsula, often found near water streams in mountain landscapes, but also in other habitats. First we obtain the presences for a species from GBIF (Global Biodiversity Information Facility, http://www.gbif.org). GBIF is a repository for biodiversity observations, and has over three billions of occurrences of over a million species all over the world at the time I am writing these words. Natural history museums, citizen science platforms such as iNaturalist ( http://www.inaturalist.org) and eBird (http://www.ebird.org), and scientists, publish their species records in GBIF using a data format called Darwin Core. There is a R package that allows one to download observations from GBIF and also other relevant geodata, the geodata package. We will be doing some geospatial processing, so let’s load also the terra package.\n\nlibrary(geodata)\nlibrary(terra)\nlibrary(predicts)\nlibrary(ggplot2)\n\nWe download the observations of Lacerta schreiberi from GBIF with the function sp_occurence(genus,species). We also download a world map with the function world(path), where path should point towards a local directory where we want to store the data.\n\nocc &lt;- sp_occurrence(\"Lacerta\",\"schreiberi\") \nworld_data &lt;- world(path = \".\") #download world countries limits\next_eur &lt;- c(-15,45,35,72) # coordinates of European extent\n\n#download bioclim data\nbioclim &lt;- worldclim_global(var = 'bioc', res = 10, path = \".\")\n\n# plot the map of Europe\nplot(world_data,  \n     xlab = \"Longitude\", ylab = \"Latitude\", axes = TRUE, ext=ext_eur)\n\n# add the species occurrences\npoints(occ$lon,occ$lat,cex=.1,col=\"blue\")\n\n# create pseudo-absences\neumask&lt;-crop(bioclim[[1]], ext(ext_eur))\nabsences&lt;-backgroundSample(eumask,nrow(occ),vect(occ),tryf=10)\npoints(absences,cex=.1,col=\"red\")\n\n\n# plot the climate variables in geographic space\nplot(bioclim[[19]],ext=ext_eur)\nplot(bioclim[[3]],ext=ext_eur)\n\n# plot the climate space figure\n# first merge occurences and absences into a single matrix\nallpts &lt;- rbind(cbind(occ$lon,occ$lat,rep(1,nrow(occ))),\n                cbind(absences,rep(0,nrow(absences))))\ncolnames(allpts)[3]&lt;-\"pres\"\n\n# extract the climate variable values for all points\nbioclim_sample&lt;-extract(bioclim,allpts[,1:2])\nallpts_bioclim &lt;- cbind(allpts,bioclim_sample)\n\nallpts_bioclim_plot&lt;-allpts_bioclim\nallpts_bioclim_plot$pres&lt;-as.factor(allpts_bioclim_plot$pres)\nggplot(allpts_bioclim_plot, aes(x=wc2.1_10m_bio_19,y=wc2.1_10m_bio_3,shape=pres, col=pres)) +\n  geom_point(size = 3, alpha=0.5) + scale_color_manual(values = c(\"0\" = \"red\", \"1\" = \"blue\")) \n\n\n\n\n\n\n\n\n\n\n\n\n(a) Geographic space\n\n\n\n\n\n\n\n\n\n\n\n(b) Bioclim 19\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) Bioclim 13\n\n\n\n\n\n\n\n\n\n\n\n(d) Climate space\n\n\n\n\n\n\n\nFigure 1.7: The geographic space and climate space of Lacerta schreiberi.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "ecophysiology.html#statistical-confrontation-regressing-the-climate-space",
    "href": "ecophysiology.html#statistical-confrontation-regressing-the-climate-space",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "1.4 Statistical confrontation: regressing the climate space",
    "text": "1.4 Statistical confrontation: regressing the climate space\nBy Andres Marmol\n\nWhy anoles? Anoles are among the most studied reptile organisms. They are vastly diverse with more than 488 species described until today — circa 11% of all the squamates without considering snakes — due to their outstanding adaptive radiation, which has inspired many to dive-in-depth into understanding how evolution has operated within this group (Lizards in an Evolutionary Tree by J. B. Losos (2009) is a highly recommended instructive reading for more info). As a result, very detailed data sets on many species of anoles, including information on micro habitat, field body temperature, activity patterns and morphological traits, performance, etc., can be found online in relatively few time.\nIn the following steps we will be downloading from Dryad and using a data set created by Winchell et al. (2016) on Anolis cristatellus making a pair-comparison of several morphological and thermal traits of individuals living in urban and forested areas at Puerto Rico. A. cristatellus is widely distributed across Puerto Rico and can be found in natural and human-intervened spaces easily. It can be seen over ground and laying on the trunks of trees in natural settings, and on walls and metal fences in more urban areas.\n\n1.4.1 Calling the dataset from Dryad\nTo download the dataset, it is necessary to install the R package rdryad.\n\ninstall.packages(\"rdryad\")\n\nThen we open the newly installed package and download the dataset by specifying the DOI associated to this dataset.\n\n#calling rdryad\nlibrary(rdryad)\n\n# Specify the DOI\ndoi &lt;- \"10.5061/dryad.h234n\"\n\n# Download the dataset using the dryad_download function\ndownloaded_file &lt;- dryad_download(dois = doi)\n\nThe data sets are now downloaded on the paths indicated in the box below, although for this exercise only table [2] winchell_evol_phenshifts.csv” is needed.\n\n# The downloaded_file will contain the file path where the dataset is saved\nprint(downloaded_file)\n\n$`10.5061/dryad.h234n`\n[1] \"/Users/henrique/Library/Caches/R/rdryad/10_5061_dryad_h234n/winchell_evol_CG.csv\"        \n[2] \"/Users/henrique/Library/Caches/R/rdryad/10_5061_dryad_h234n/winchell_evol_phenshifts.csv\"\n\n\nOnce this is done, it is always good practice to check if the recently open data frame works by checking the columns within the data frame.\n\n#calling the dataset of interest as df\ndf &lt;- read.csv(downloaded_file[[1]][2])\n\n# checking the columns (variables) available in the data frame df using the str function\nnames(df)\n\n [1] \"ID\"                 \"date\"               \"Site\"              \n [4] \"context\"            \"perch\"              \"bodytemp.C\"        \n [7] \"perch.temp.C\"       \"ambient.temp.C\"     \"humidity.percent\"  \n[10] \"perch.height.cm\"    \"perch.diam.cm\"      \"weight.g\"          \n[13] \"head.height.mm\"     \"svl.mm\"             \"local.time.decimal\"\n[16] \"flags\"              \"JL\"                 \"JW\"                \n[19] \"METC\"               \"RAD\"                \"ULN\"               \n[22] \"HUM\"                \"FEM\"                \"TIB\"               \n[25] \"FIB\"                \"METT1\"              \"METT2\"             \n[28] \"FL\"                 \"HL\"                \n\n\nThere are 29 different variables within df, but this exercise will focus only in a few of them including context, perch, bodytemp.C, perch.temp.C, ambient.temp.C, and local.time.decimal where context indicates if the lizard was captured in natural or urban spaces; perch refers to the microhabitat where the lizard was found; bodytemp.C is body temperature \\(b\\); perch.temp.C is substrate temperature \\(T_s\\); ambient.temp.C is air temperature \\(a\\); and local.time.decimal is the time of the day in hours when the lizards was captured and measured.\n\n\n1.4.2 Exploring the thermophysiological data of A. cristatellus.\nAs covered in the first chapter, \\(b\\) increases proportionally to \\(a\\) as indicated in equation (1.2). Let’s check if the data confirms this equation.\n\n# to call a variable directly from a data frame one must use $, indicating the name of the dataframe at the left and the name of the variable (columnt on the right).\n\nplot(df$ambient.temp.C, df$bodytemp.C,\n     xlab=\"air temperature (°C)\",\n     ylab=\"body temperature (°C)\")\n\n\n\n\n\n\n\n\nIn the plot we can observe that indeed body temperature increases with increasing temperature. However, we cannot quantitatively know how much is this increase. For that, we can model how air temperature affects body temperature modelling them a a line with the equation:\n\\[\n\\hat{y} = α + β*x + e\n\\] where \\(\\hat{y}\\) is the predicted value of \\(y\\) for any given \\(x\\); \\(α\\) is point of intersection of the line when \\(x=0\\), \\(β\\) is the slope of the regression line (i.e. how much increases \\(\\hat{y}\\) with a unit increase in \\(x\\)) and \\(e\\) is the random error.\nPlacing our variables in formula, it would look like this:\n\\[\nb = b_{0} + β*a + e\n\\]\nwhere \\(b\\) is body temperature, \\(a\\) is ambient temperature, and \\(b_0\\) is the body temperature when \\(a\\) is zero.\nNow lets model it using a least-squares linear regression using the lm function in R.\n\n#define the linear model\n#the variable at the left of the tilde (~) is the dependent variable\n#data calls the specific dataframe to be used.\n\nmodel1 &lt;- lm(bodytemp.C ~ ambient.temp.C, data=df)\n\n# print model outputs\nprint(model1)\n\n\nCall:\nlm(formula = bodytemp.C ~ ambient.temp.C, data = df)\n\nCoefficients:\n   (Intercept)  ambient.temp.C  \n        8.7004          0.7237  \n\n\n\n\n1.4.3 Interpreting the results of our model.\nThe results of our model indicates that if the air temperature (\\(a\\)) is zero, A. cristatellus would show a body temperature (\\(b\\)) of 8.7 °C, which increases in approximately 0.7 °C for each 1 °C increase in air temperature.\nNow it is also possible to draw a few predictions\n\n# a number of possible ambient temperatures that can be found in Puerto Rico during the day\n\namb_temps = data.frame(ambient.temp.C = seq(27,38, 1))# defines a vector with values from 27 to 38, with one unit increase\n\npredict(model1, newdata=amb_temps)\n\n       1        2        3        4        5        6        7        8 \n28.23967 28.96335 29.68702 30.41070 31.13437 31.85805 32.58172 33.30540 \n       9       10       11       12 \n34.02907 34.75275 35.47642 36.20010 \n\n\n\n\n1.4.4 How good our model is performing?\nGraphically the linear model fits the data as follows:\n\n# Create the scatter plot\nplot(df$ambient.temp.C, df$bodytemp.C,\n     xlab=\"air temperature (°C)\",\n     ylab=\"body temperature (°C)\")\n\n# add the line of fit from our recently created linear model \"model1\"\nabline(model1, col = \"red\", lwd= 2)\n\n\n\n\n\n\n\n\nThe red line in the plot follows very well the pattern of increase shown by our data. It is noticeable, however, that some points fall farther from the line of best fit than others. In other words, many \\(\\hat{y}\\) values (body temperature) are predicted with larger errors than others, for a given \\(x\\) value (ambient temperature). These errors are also known as residuals, and are the vertical distance between the observed values and the line of best fit. They are graphically represented in green in our plot:\n\n\n\n\n\n\n\n\n\nWhat a least square linear regression does is to find the lowest sum of squares of the residuals (every green line in the plot) so that the least amount of error is kept in the linear model.\nFinally, how well the model fits the data? In our example, the body temperatures do not perfectly fall on the line of best fit, and many of them are scattered around it. A common metric assess this question in a simple regression model is the \\(r^2\\). \\(r^2\\) values indicates how much of the variance of body temperature (our dependent variable) is explained by ambient temperature (our independent variable). A perfect fit is indicated by an \\(r^2\\) of 1, while no fit would be zero. To check the \\(r^2\\) in our model we can simply use the summary function in R.\n\n# obtaining the r-squared of our model\n\nsummary(model1)$r.squared\n\n[1] 0.5736088\n\n\n\\(r^2\\) equals 0.574 indicating that almost 60% of the variance in body temperature is explained by ambient temperature.\nIn summary, our expectation that lizards body temperature increases depending on how the temperature in their environment changes has been confirmed. Specifically for A. cristatellus in this study, body temperature increases ~ 0.7 °C every 1 degree increase in air temperature. A few questions remain. For example, does habitat has an effect in the body temperature in A. cristatellus, and if it does, how different could the body temperatures of the lizards in habitat A are from those in habitat B?\n\n\n\n\nGuisan, Antoine, Wilfried Thuiller, and Niklaus E. Zimmermann. 2017. Habitat Suitability and Distribution Models: With Applications in r. Cambridge University Press.\n\n\nHuey, B. 1982. “Temperature, Physiology, and the Ecology of Reptiles.” In, edited by Carl Gans and F. Harvey. New York: Academic Press.\n\n\nLosos, Jonathan B. 2009. Lizards in an Evolutionary TreeEcology and Adaptive Radiation of Anoles. University of California Press. https://doi.org/10.1525/california/9780520255913.001.0001.\n\n\nWinchell, Kristin M., Robert Graham Reynolds, Sofia R. Prado-Irwin, Alberto R. Puente-Rolón, and Liam J. Revell. 2016. “Data from: Phenotypic Shifts in Urban Areas in the Tropical Lizard Anolis Cristatellus.” https://doi.org/10.5061/DRYAD.H234N.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "ecophysiology.html#footnotes",
    "href": "ecophysiology.html#footnotes",
    "title": "1  Ecophysiology and the climate space: when to bask in the sun?",
    "section": "",
    "text": "The concept of equilibrium is very important in ecological theory. It is often introduced in the context of differential equations and corresponds to the point at which the derivative of the variable of interest is zero. The heat equation can also be seen as a differential equation where \\(f\\) corresponds to the derivative of the amount of heat \\(Q\\) in the lizard through time \\(t\\), i.e. \\(dQ/dt\\).↩︎",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecophysiology and the climate space: when to bask in the sun?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html",
    "href": "optimalforaging.html",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "",
    "text": "2.1 Searching predator\nThe searching predator is typified as an animal that actively searchs for food. For instance, wolfs roam the landscape constantly searching for their prey (Figure 2.1). The question is then, any time that a forager comes across a prey whether to spend the time catching and eating it, or continuing to search for another prey, for instance a larger or easier prey item. Joan Roughgarden also liked this type of foraging to the sushi-bar problem where dishes are coming one after the other on a moving tray, and a person needs to decide whether to pick a given dish. This decision is particularly akin to the searching predator situation when one assumes that a person can have only one dish at a time in her or his table, We consider two types of searching predators: time minimizers and energy maximizers.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html#searching-predator",
    "href": "optimalforaging.html#searching-predator",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "",
    "text": "Figure 2.1: A pack of wolf (Canis lupus) roaming around the landscape of Peneda-Gerês National Park, Portugal.\n\n\n\n\n2.1.1 Time minimizer\nMany searching predators are themselves preys to other animals. For instance shrews search for insects to eat, but can be themselves eaten by carnivores or owls. Therefore a reasonable assumption is that they are making foraging decisions that minimize the time foraging. Let’s assume there are two types of prey items, type 1 and 2. These two preys occur at different abundances in the environment, let’s name them \\(a_1\\) and \\(a_2\\). These abundances can be measured as encounter rates from the predator perspective, this is the number of prey items found per unit time. The two types of prey also have different handling times, this is the amount of time required to chase and process the prey, \\(h_1\\) and \\(h_2\\) . We also convention to call the type 1 prey the prey with the lowest handling time, i.e. \\(h_1&lt;h_2\\),\nA searching predator can adopt one of the following three strategies:\n\nStrategy 1: to consume only prey items of type 1\nStrategy 2: to consumer only prey items of type 2\nStrategy 1&2: to consumer both types of prey\n\nIn order to find out which strategy should be adopted by the forager, one needs to calculate the average spent per food item in each of the strategies. For Strategy 1 the average time per item, \\(T_1\\) is the sum of the amount of time the predator needs to encounter a prey with the amount of time that it takes to process that prey. As the abundance is measured in encounter rates, i.e. prey items per unit time, the inverse of that is the waiting time for a prey. Therefore we have for Strategy 1,\n\\[T_1=1/a_1+h_1 \\tag{2.1}\\]\nSimilarly, for Strategy 2, the average time per item \\(T_2\\) is given by\n\\[T_2=1/a_2+h_2. \\tag{2.2}\\]\nA more interesting case is Strategy 3. Here the waiting time is the inverse of the sum of the abundances of both times of prey, while the handling time is average of the handling times of both ypes of prey weighted by their relative abundance,\n\\[\nT_{3}=\\frac{1}{a_1+a_2}+\\frac{a_1 h_1+a_2 h_2}{a_1+a_2}\n\\tag{2.3}\\]\nWe can now define the problem that the forager has to solve as to find the strategy \\(i\\) that minimizes \\(T_i\\):\n\\[\nmin(T_i) \\quad \\text{for} \\quad i=1, 2, 3\n\\]\nIt is easy to demonstrate that Strategy 2 is always worse than Strategy 3, independently of the abundances of the two types of prey. This happens because Strategy 3 always implies a longer waiting time than the two other specialized strategies (i.e. one has to wait less time to find any item of an prey than items of a given prey time, \\(1/(a_1+a_2)&lt;1/a_2\\)) and the handling time of strategy 3 can never be higher than the handling time of strategy 2 (it’s always a value betwen \\(h_1\\) and \\(h_2\\)). So we can exclude Strategy 2 from our analysis. The choice is then between Strategy 1, just taking items of the preferred prey item, and 3, taking items of both types of prey. Let’s assess this two strategies with a little bit of help from R. We start by assuming that the handling time of prey type 1 is 1 second while prey type 2 takes 60 seconds. Let’s also assume that the abundance of prey type 2 is 0.05 individuals per second, i.e. one individuals needs to wait in average 20 seconds to find prey type 2.\n\n\nh1=1           #Handling time of prey type 1 (s)\nh2=60          #Handling time of prey type 2 (s)\na2=0.05        #abundance of prey type 2 (ind/s)\n\nLet’s now plot the time per item of each of the strategies as a function of the abundance of the preferred prey.\n\na1&lt;-seq(0.005,0.1,0.001)   #abundance of prey time 1 (ind/s)\nt1=1/a1+h1                 #time per item of Strategy 1 (s)\nt3=1/(a1+a2)+h1*a1/(a1+a2)+h2*a2/(a1+a2) #time per item of Strategy 2 (s)\nplot(a1,t1, type=\"l\", col=\"blue\")\nlines(a1,t3, type=\"l\", col=\"red\")\nlegend(\"topright\",                    \n       legend = c(\"Strategy 1\", \"Strategy 3\"),  # Labels\n       col = c(\"red\", \"blue\"),             # Line colors\n       lwd = 2,                            # Line width\n       lty = 1)      \n\n\n\n\n\n\n\n\nThere is a critical threshold of the abundance of prey type 1 above which strategy 1 is preferrable, while below that threshold strategy 3 is the best strategy. Interestingly this threshold does not depend on the abundance of the less preferable prey. For instance, if we assume a low abundance of prey time 2 at 0.01, the resulting plot is:\n\na2 = 0.01\nt1=1/a1+h1                 #time per item of Strategy 1 (s)\nt3=1/(a1+a2)+h1*a1/(a1+a2)+h2*a2/(a1+a2) #time per item of Strategy 2 (s)\nplot(a1,t1, type=\"l\", col=\"blue\")\nlines(a1,t3, type=\"l\", col=\"red\")\n\n\n\n\n\n\n\n\nTo determine this critical threshold one can compare the two vectors, T1 and T3, and find the first position at which T1 becomes smaller than T3,\n\npos=which(t1&lt;t3)[1]\na1[pos]\n\n[1] 0.017\n\n\nSo the critical threshold for these handling times occurs when \\(a_1=0.017\\) individuals per second.\n\n\n2.1.2 Energy per time maximizer\nPerhaps more often, animals try to maximize their energy yield (benefits) while minimizing the time foraging (costs). Or in another way of looking at it, they try to maximize their energy yield per unit time. We already know the time per item associated to each of the three strategies of the searching predator. We now need to caiculate the average energy yield per item. Consider now that the energy content of the prey items are \\(e_1\\) and \\(e_2\\) for prey of type 1 and 2, respectively. We define prey 1 as the preferred type of prey, so we assume that the ratio of the energic content (measured for instance in calories) to the handling time is higher for type 1 prey, i.e. \\(e_1/h_1&gt;e_2/h_2\\). Now we calculate the energy yield per item for each strategy. We start with the energy content of the prey, but need to subtract the energy spent while waiting the prey and the energy spent chasing and processing the prey,\n\\[\nE_1=e_1-ew*tw_1-eh*h_1\n\\tag{2.4}\\]\nwhere \\(ew\\) and \\(eh\\) are the energy spent per unit time while waiting for the prey and the energy spent per unit time while handling, respectively. They can both be measured for instance in cal/s. We already know from the time minimizer that the waiting time for the prey is the inverse of the abundance, \\(tw_1=1/a_1\\). Therefore substituting in Equation 2.4 we have\n\\[\nE_1=e_1-\\frac{ew}{a_1}-eh*h_1.\n\\tag{2.5}\\]\nA similar expression can be written for Strategy 2, replacing 1 with 2 in Equation 2.4.\n\\[\nE_2=e_2-\\frac{ew}{a_2}-eh*h_2.\n\\tag{2.6}\\]\nMore interesting is to derive the expression for Strategy 3, where the foragers takes both types of prey. The energy content of the prey is the average of the energetic contents of each prey type, weighted by their abundances, \\((e_1*a_1+e_2*a_2)/(a_1+a_2)\\). The waiting time is the inverse of the sums of the abundances of preys of both types, as in Equation 2.3. The handling time is the average of the handling times of each prey type, weighted by their abundances. So we have,\n\\[\nE_3=\\frac{e_1*a_1+e_2*a_2}{a_1+a_2}-\\frac{ew}{a_1+a_2}-eh\\frac{h_1*a_1+h_2*a_2}{a_1+a_2}.\n\\tag{2.7}\\]\nFinally we can calculate the energy per unit time for each strategy by dividing Equation 2.5 by Equation 2.1 for Strategy 1, dividing Equation 2.6 by Equation 2.2 for Strategy 2, and dividing Equation 2.7 by Equation 2.3 for strategy 3,\n\\[\nET_i=\\frac{E_i}{T_i}\n\\]\nSimilarly to the time minimizer, it’s possible to show mathematically that strategy 2 is never an optimal strategy. So the interesting comparison is again between strategy 1 and strategy 3. Let’s use R to plot the energy per time yield for both strategies. We start by setting the parameter values of our model with some realistic numbers.\n\ne1&lt;-10                       #Caloric content of prey 1\ne2&lt;-100                      #Caloric content of prey 2\nh1&lt;-1                        #Handling time of prey 1\nh2&lt;-60                       #Handling time of prey 2\new&lt;-1                        #Energy spend per unit time while waiting (cal/s)\neh&lt;-1                        #energy spend per unit time handling the prey (cal/s)\n\nWe will examine the energy yields for strategy 1 and strategy 3 for a fixed abundance of prey type 2 and a sequence of abundances of prey type 1 from 0.005 individuals per second to 0.5 individuals per second\n\na1&lt;- seq(0.005,0.5,0.001)    #Sequence of abundances of prey 1\na2&lt;-0.05\n\nWith the parameter and abundance values defined, we can calculate \\(E_1\\), \\(E_3\\), \\(T_1\\), \\(T_3\\), and then \\(ET_1\\) and \\(ET_3\\) based on the equations above, resulting in vectors for these variables with each entry in the vector corresponding to an abundance value in the vector of abundances a1.\n\nE1 = e1 -(eh*h1) - ew/a1    #energy per item of Strategy 1 (s)\nE3 = (e1*a1+e2*a2)/(a1+a2)-\n     eh*(h1*a1+h2*a2)/(a1+a2)-ew/(a1+a2) #energy per item of Strategy 3 (s)\n\nT1=1/a1+h1                 #time per item of Strategy 1 (s)\nT3=1/(a1+a2)+h1*a1/(a1+a2)+h2*a2/(a1+a2) #time per item of Strategy 3 (s)\n\nET1 = E1/T1 #energy per time of strategy 1\nET3 = E3/T3 #energy per time of strategy 3\n\nNext we plot the energy yields against the values of abundance of prey of type 1, and add a nice legend:\n\nplot(a1,ET1,type=\"l\",xlab=\"Abundance of prey 1\", ylab=\"Energy per time\", col=\"blue\")\nlines(a1,ET3,type=\"l\",col=\"red\")\nlegend(\"topright\",                    \n       legend = c(\"Strategy 1\", \"Strategy 3\"),  # Labels\n       col = c(\"red\", \"blue\"),             # Line colors\n       lwd = 2,                            # Line width\n       lty = 1) \n\n\n\n\n\n\n\n\nSimilarly to the the time minimizer, for the energy maximizer there is also a critical threshold of the abundance of prey type 1 above which strategy 1 is preferrable, while below that threshold strategy 3 is the best strategy.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html#sit-and-wait-predator",
    "href": "optimalforaging.html#sit-and-wait-predator",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "2.2 Sit-and-wait predator",
    "text": "2.2 Sit-and-wait predator\nIn contrast to the searching predator, the sit-and-wait predator forages by patiently ambushing its prey. For instance, the lizard Anolis gingivinus (Figure 2.2) waits in a perch, often a tree trunk, for a prey to come into its reach, sprinting then down the trunk or into the ground to capture its prey, returning then to its perch again. So here the decision that the predator has to take after seeing the prey is whether it should run an capture the prey or if it should ignore it.\n\n\n\n\n\n\nFigure 2.2: An Anolis gingivinus, a sit-and-wait predator, captures a prey after running down from its perch. Photo taken in the island of Saint Martin, Leward Islands, Caribbean.\n\n\n\nWe will build on the model we developed for the energy per time maximizer searching predator to develop a model for the decisions of the sit-and-wait predator. The energy per prey item consumed is,\n\\[\nE=e-ep t_p-e_w t_w\n\\tag{2.8}\\]\nwhere \\(e_p\\) is the energy per unit time while pursuing the prey, \\(t_p\\) is the average time it takes to sprint to the prey and come back to the perch, \\(e_w\\) is the energy per unit time while waiting for the prey, and \\(t_w\\) is the average time it takes to wait for a prey item to show up within the home-range or territory of the predator. We will use these two terms interchangeably, although they are sometimes used in the literature differently.\nLet’s consider that the home-range of the lizard is shaped as a semi-circle centered in the perch. This is the lizard has a viewing angle of \\(180\\deg\\) from its perch (Figure 2.3). Then the total abundance of the the prey in the territory is the integral of the prey point density over the territory. So, using polar coordinates for the integral this can be written as,\n\\[\nA=\\int_{0}^{r_c}a \\pi r dr\n\\]\nThe waiting time is just the inverse of the total abundance.\n\\[t_w=1/A=\\frac{1}{\\int_{0}^{r_c}a \\pi r dr}\\]\n\n\n\n\n\n\nFigure 2.3: Feeding territory of a sit-and-wait predator with radius \\(r_c\\).\n\n\n\nThe average pursuit time is a bit more complicated. For a prey landing at distance \\(r\\) from the predator, the pursuit time is the time the lizards needs to run to that location and back. This is can be calculated by dividing the double of the distance by the speed of the lizard, \\(2r/v\\). We have now to average these sprint times over the range of possibile distance that the lizard can run, from 0 to the radius of its territory \\(r_c\\), weighted by the probability of a prey appearing at each distance. The probability of a prey appearing at distance \\(r\\) is the length of the semi-circle with radius \\(r\\) multiplied by the point density of prey divided by the total density of prey in the territory of the lizard, \\(a \\pi r / A\\). So we now need to calculate the integral of the sprint times at each distance times the probability of running to a prey at that distance over the range of possible radius values,\n\\[\nt_p=\\int_{0}^{r_c} \\frac{2r}{v} \\frac{a \\pi r}{A} \\ dr\n\\]\nThe average time per prey item consumed is simply the sum of the average pursuit time, \\(t_p\\), and the average waiting time \\(t_w\\),\n\\[\nT=t_p+t_w\n\\tag{2.9}\\]\nTherefore the energy per time that the optimal sit-and-wait predator wants to maximize is obtained by dividing Equation 2.8 by Equation 2.9,\n\\[\nET(r_c)=\\frac{e-e_p t_p(r_c)-e_w t_w(r_c)}{t_p(r_c)+t_w(r_c)}\n\\]\nwhere we highlighted that the wating time and the pursuit time are functions of the territory size or cut-off radius \\(r_c\\).\nThe optimal decision is to find the cut-off radius \\(r_c\\) that maximizes the energy per time,\n\\[\n\\max_{r_c}(ET)\n\\]\nLet’s plot the energy per time as a function of the territory size,\n\new&lt;-0.1                  #Energy per unit of time of waiting\nep&lt;-1                    #Energy per unit of time of pursuing the prey\nv&lt;-0.5                   #Velocity of the predator in chase\na&lt;-0.005                 #Abundance of prey\ne&lt;-10                    #Energy value of the prey\n\nrc&lt;-seq(0.001,4,0.001)   #Radius of the hunting ground \n\ntw &lt;- 1/(a*pi*((rc^2)/2))   #Waiting time \ntp&lt;-4/3*rc/v                #Pursuing time\nti&lt;-tw+tp                   #Time per item \nei&lt;-e-ew*tw-ep*tp           #Energy per item\net&lt;-ei/ti                   #Energy per unit of time\n\net &lt;-function()\n{\n  (e-ew*(1/(a*pi*((rc^2)/2)))-ep*(4/3*rc/v))/(1/(a*pi*((rc^2)/2))+4/3*rc/v)\n}\n\nplot(rc,et(),type=\"l\",\n     xlab=\"Radius of the territory\",\n     ylab=\"Energy per unit of time (cal/sec) \")\n abline(0,0)\n\n\n\n\n\n\n\n\nIf you wanna read about an empirical test of this model, I suggest the paper by Shaffir and Rougharden [@-shafir1998].",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html#does-natural-selection-maximizes-fitness",
    "href": "optimalforaging.html#does-natural-selection-maximizes-fitness",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "2.3 Does natural selection maximizes fitness?",
    "text": "2.3 Does natural selection maximizes fitness?\n\nSimple models of population genetics for frequency independent selection.\nSomething on Tinberger, Konrad Lorenz on the genetic basis of behavior",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html#statistical-confrontation-finding-the-maximum",
    "href": "optimalforaging.html#statistical-confrontation-finding-the-maximum",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "2.4 Statistical confrontation: finding the maximum",
    "text": "2.4 Statistical confrontation: finding the maximum\n\nExplain how to find the maximum of a function with R. Parallel between genetic algorithms and optimization.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "optimalforaging.html#section",
    "href": "optimalforaging.html#section",
    "title": "2  Economic models of behavior: do animals optimize?",
    "section": "2.5 ",
    "text": "2.5 \n\n\n\n\nPyke, Graham H. 1984. “Optimal Foraging Theory: A Critical Review.” Annual Review of Ecology and Systematics 15 (January): 523–75. http://www.jstor.org/stable/2096959.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic models of behavior: do animals optimize?</span>"
    ]
  },
  {
    "objectID": "gametheory.html",
    "href": "gametheory.html",
    "title": "3  Conflict resolution in ecology and evolution: war and peace",
    "section": "",
    "text": "3.1 The prisoner’s dillema and the evolution of cooperation\nA lot of the empahsis on evolutionary biology and ecology is place on competition, on the idea of “survival of the fittest” and that selection operates at the level of individuals favoring selfish behaviors. However, cooperation is super common in nature, from praire dogs taking turn as sentinels, informing the group of the arrival of a predator, to back scratching in primates. One beautiful explanation for such cooperation is based on the principles of kin selection, developed by Bill Hamilton, or the idea that it makes evolutionary sense to help others if they are genetically related to you, as this increases the probability of the same genes you have to be passed into the next generation. Hamilton’s contribution to this problem was seminal because he noted that genetic relatedness can be particularly high between females in haploid-diploid systems such as bees and ants, leading to a widespread of cooperating in rearing offspring and even the abdication of many individuals from reproducing in favor of assisting the queen. But can cooperation also evolve in the absence of genetic relatedness? This is the problem that can be studied with the prisoner’s dilemma.\nIn the prisionner’s dilemma game there are two players. it is inspired by a situation where two suspects of being accomplices in a crime are arrested and are being questioned in separate rooms without contact between them. They are faced with the dilemma of cooperating with each other by claimng inocence, or cutting a deal with the investigators by recognizing the responsibility for the crime and by denouncing the other player. If both cooperate they can potetinally get both away, but if one accomplice cooperates and the other defects, then the one that cooperated gets the maximum penalty.\nWe can formalize the prisoner’s dilemma game by stating that each player can choose one of two strategies in each round of the game, defect or cooperate The pay-off matrix of the Prisionner’s Dillema, from the pespective of player 1 (rows), playing against player 2 (columns) is\n\\[\n\\begin{array}{c|cc}\\text{Player 1} \\backslash \\text{Player 2} & C & D \\\\\n\\hline\nC & 3 & 0 \\\\D & 5 & 1\\end{array}\n\\]\nYou can think of the pay-off points as a fitness gain in relation to the fitness before the play. The exact payoffs are not so important, and there are other variants of the game with different pay-offs. Instead, it is the relationship between the different pay-offs that determines the best strategy for the game. If the players knew what the other player would do, the best collective strategy would be to cooperate, as they both would receive 3 points for a total of 6 points. If one of the players defects while the other cooperate they accrue collectively only 5 points, while if both defect they would accrue together 2 points. But they don’t know what the other player is going to do (non-cooperative game) and need to make a decision that maximizes their individual fitness. What should they do?\nThe general solution that both Maynard Smith and Nash came up for these games is that one needs to identify which strategy is the best response to itself. This is called an Evolutionary Stable Strategy (ESS, also known as Nash Equilibrium1) because it is the strategy that when dominant in the population cannot be invaded by any other strategy. Mathematically speaking, the ESS is the strategy \\(S^*\\) that has the higher payoff when played against itself,\n\\[\n\\forall S_i  ,\\quad E(S^*,S^*) \\geq E(S_i,S^*)\n\\]",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Conflict resolution in ecology and evolution: war and peace</span>"
    ]
  },
  {
    "objectID": "gametheory.html#the-hawk-dove-game-and-animal-contests",
    "href": "gametheory.html#the-hawk-dove-game-and-animal-contests",
    "title": "3  Conflict resolution in ecology and evolution: war and peace",
    "section": "3.2 The Hawk-Dove game and animal contests",
    "text": "3.2 The Hawk-Dove game and animal contests",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Conflict resolution in ecology and evolution: war and peace</span>"
    ]
  },
  {
    "objectID": "gametheory.html#the-war-of-atttrition",
    "href": "gametheory.html#the-war-of-atttrition",
    "title": "3  Conflict resolution in ecology and evolution: war and peace",
    "section": "3.3 The war of atttrition",
    "text": "3.3 The war of atttrition\n\n\n\n\n\nDugatkin, Lee Alan, and Hudson Kern Reeve. 1998. Game Theory & Animal Behavior. Oxford University Press.\n\n\nMaynard Smith, J. 1982. Evolution and the Theory of Games. Cambridge: Cambridge University Press.",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Conflict resolution in ecology and evolution: war and peace</span>"
    ]
  },
  {
    "objectID": "gametheory.html#footnotes",
    "href": "gametheory.html#footnotes",
    "title": "3  Conflict resolution in ecology and evolution: war and peace",
    "section": "",
    "text": "There’s a small difference between the two, see (Dugatkin and Reeve 1998).↩︎",
    "crumbs": [
      "Ecology of individuals",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Conflict resolution in ecology and evolution: war and peace</span>"
    ]
  },
  {
    "objectID": "modellingbiochange.html",
    "href": "modellingbiochange.html",
    "title": "5  Modelling biodiversity change: winners and losers",
    "section": "",
    "text": "Every minute about 2 football fields of native forest are cleared somewhere in the world. What are the consequences of land-use change for biodiversity?",
    "crumbs": [
      "Ecology of communities",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Modelling biodiversity change: winners and losers</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Dugatkin, Lee Alan, and Hudson Kern Reeve. 1998. Game Theory &\nAnimal Behavior. Oxford University Press.\n\n\nGuisan, Antoine, Wilfried Thuiller, and Niklaus E. Zimmermann. 2017.\nHabitat Suitability and Distribution Models: With Applications in\nr. Cambridge University Press.\n\n\nHilborn, Ray, and Marc Mangel. 1997. The Ecological Detective:\nConfronting Models with Data. 1st ed. Princeton University Press.\n\n\nHuey, B. 1982. “Temperature, Physiology, and the Ecology of\nReptiles.” In, edited by Carl Gans and F. Harvey. New York:\nAcademic Press.\n\n\nLosos, Jonathan B. 2009. Lizards in an Evolutionary TreeEcology and\nAdaptive Radiation of Anoles. University of California Press. https://doi.org/10.1525/california/9780520255913.001.0001.\n\n\nMaynard Smith, J. 1982. Evolution and the Theory of Games.\nCambridge: Cambridge University Press.\n\n\nOtto, Sarah P., and Troy Day. 2007. A Biologist’s Guide to\nMathematical Modeling in Ecology and Evolution. Princeton\nUniversity Press. https://doi.org/10.1515/9781400840915.\n\n\nPyke, Graham H. 1984. “Optimal Foraging Theory: A Critical\nReview.” Annual Review of Ecology and Systematics 15\n(January): 523–75. http://www.jstor.org/stable/2096959.\n\n\nRoughgarden, J. 1998. Primer of Ecological Theory. Upper Saddle\nRiver, New Jersey: Prentice Hall.\n\n\nWinchell, Kristin M., Robert Graham Reynolds, Sofia R. Prado-Irwin,\nAlberto R. Puente-Rolón, and Liam J. Revell. 2016. “Data from:\nPhenotypic Shifts in Urban Areas in the Tropical Lizard Anolis\nCristatellus.” https://doi.org/10.5061/DRYAD.H234N.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "intro_to_R.html",
    "href": "intro_to_R.html",
    "title": "Appendix A — A brief R tutorial",
    "section": "",
    "text": "A.1 Basic data structures",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#basic-data-structures",
    "href": "intro_to_R.html#basic-data-structures",
    "title": "Appendix A — A brief R tutorial",
    "section": "",
    "text": "A.1.1 Variables\nVariables can be any sequence of letter and numbers, but # it cannot start with a number\n\nx = 2\nx &lt;- 4\n2+2 \n\n[1] 4\n\ny &lt;- x^5\ny\n\n[1] 1024\n\n\nPlease note that you can comment code by using the # character.\n\n\nA.1.2 Vectors\nLet’s create vectors.\n\n# Introduction to vectors\nv1 &lt;- c(2,3,6,12)\nv2 &lt;- 1:100\nlength(v2)\n\n[1] 100\n\nv2\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100\n\nv3 &lt;- seq(1,100,5)  # call without naming arguments\nv3\n\n [1]  1  6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96\n\nv3 &lt;- seq(from=1,to=100,by=5) # call with names of arguments\nv3\n\n [1]  1  6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96\n\nv3 &lt;- seq(to=100,by=5) # call skipping the first argument\n#and using the default value 1 - see help(seq)\nv3\n\n [1]  1  6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96\n\nv3 &lt;- seq(by=5,to=100) # call by arguments and change order or arguments\n\nHow to index vectors?\n\n# Indexing vectors\nv3[3] #uses square brackets to obtain the third element of the vector\n\n[1] 11\n\nv3&gt;20 # produce a vector of boolean values that are TRUE when\n\n [1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n\n      #v3 is greater than 20\nv3[v3&gt;20] # select from v3 all the values that are greater than 20\n\n [1] 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96\n\nv4&lt;-c(1,2,3,4,5)\nv4[c(FALSE,TRUE,FALSE,TRUE,FALSE)] #select from v4 the second and fourth element\n\n[1] 2 4\n\nv3[1:10] # first ten elements\n\n [1]  1  6 11 16 21 26 31 36 41 46\n\nv3[-1] # dropping first element\n\n [1]  6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96\n\nhead(v2) # prints the first few elements of v2\n\n[1] 1 2 3 4 5 6\n\ntail(v2) # prints the last few elements of v2\n\n[1]  95  96  97  98  99 100\n\nwhich(v3 == 26) # returns the position of v3 that equals 26\n\n[1] 6\n\n\nWhat kind of numerical operations are possible on vectors?\n\n2^v2\n\n  [1] 2.000000e+00 4.000000e+00 8.000000e+00 1.600000e+01 3.200000e+01\n  [6] 6.400000e+01 1.280000e+02 2.560000e+02 5.120000e+02 1.024000e+03\n [11] 2.048000e+03 4.096000e+03 8.192000e+03 1.638400e+04 3.276800e+04\n [16] 6.553600e+04 1.310720e+05 2.621440e+05 5.242880e+05 1.048576e+06\n [21] 2.097152e+06 4.194304e+06 8.388608e+06 1.677722e+07 3.355443e+07\n [26] 6.710886e+07 1.342177e+08 2.684355e+08 5.368709e+08 1.073742e+09\n [31] 2.147484e+09 4.294967e+09 8.589935e+09 1.717987e+10 3.435974e+10\n [36] 6.871948e+10 1.374390e+11 2.748779e+11 5.497558e+11 1.099512e+12\n [41] 2.199023e+12 4.398047e+12 8.796093e+12 1.759219e+13 3.518437e+13\n [46] 7.036874e+13 1.407375e+14 2.814750e+14 5.629500e+14 1.125900e+15\n [51] 2.251800e+15 4.503600e+15 9.007199e+15 1.801440e+16 3.602880e+16\n [56] 7.205759e+16 1.441152e+17 2.882304e+17 5.764608e+17 1.152922e+18\n [61] 2.305843e+18 4.611686e+18 9.223372e+18 1.844674e+19 3.689349e+19\n [66] 7.378698e+19 1.475740e+20 2.951479e+20 5.902958e+20 1.180592e+21\n [71] 2.361183e+21 4.722366e+21 9.444733e+21 1.888947e+22 3.777893e+22\n [76] 7.555786e+22 1.511157e+23 3.022315e+23 6.044629e+23 1.208926e+24\n [81] 2.417852e+24 4.835703e+24 9.671407e+24 1.934281e+25 3.868563e+25\n [86] 7.737125e+25 1.547425e+26 3.094850e+26 6.189700e+26 1.237940e+27\n [91] 2.475880e+27 4.951760e+27 9.903520e+27 1.980704e+28 3.961408e+28\n [96] 7.922816e+28 1.584563e+29 3.169127e+29 6.338253e+29 1.267651e+30\n\nlog(v2)\n\n  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101\n  [8] 2.0794415 2.1972246 2.3025851 2.3978953 2.4849066 2.5649494 2.6390573\n [15] 2.7080502 2.7725887 2.8332133 2.8903718 2.9444390 2.9957323 3.0445224\n [22] 3.0910425 3.1354942 3.1780538 3.2188758 3.2580965 3.2958369 3.3322045\n [29] 3.3672958 3.4011974 3.4339872 3.4657359 3.4965076 3.5263605 3.5553481\n [36] 3.5835189 3.6109179 3.6375862 3.6635616 3.6888795 3.7135721 3.7376696\n [43] 3.7612001 3.7841896 3.8066625 3.8286414 3.8501476 3.8712010 3.8918203\n [50] 3.9120230 3.9318256 3.9512437 3.9702919 3.9889840 4.0073332 4.0253517\n [57] 4.0430513 4.0604430 4.0775374 4.0943446 4.1108739 4.1271344 4.1431347\n [64] 4.1588831 4.1743873 4.1896547 4.2046926 4.2195077 4.2341065 4.2484952\n [71] 4.2626799 4.2766661 4.2904594 4.3040651 4.3174881 4.3307333 4.3438054\n [78] 4.3567088 4.3694479 4.3820266 4.3944492 4.4067192 4.4188406 4.4308168\n [85] 4.4426513 4.4543473 4.4659081 4.4773368 4.4886364 4.4998097 4.5108595\n [92] 4.5217886 4.5325995 4.5432948 4.5538769 4.5643482 4.5747110 4.5849675\n [99] 4.5951199 4.6051702\n\nv5 &lt;- 101:200\nv5/v2\n\n  [1] 101.000000  51.000000  34.333333  26.000000  21.000000  17.666667\n  [7]  15.285714  13.500000  12.111111  11.000000  10.090909   9.333333\n [13]   8.692308   8.142857   7.666667   7.250000   6.882353   6.555556\n [19]   6.263158   6.000000   5.761905   5.545455   5.347826   5.166667\n [25]   5.000000   4.846154   4.703704   4.571429   4.448276   4.333333\n [31]   4.225806   4.125000   4.030303   3.941176   3.857143   3.777778\n [37]   3.702703   3.631579   3.564103   3.500000   3.439024   3.380952\n [43]   3.325581   3.272727   3.222222   3.173913   3.127660   3.083333\n [49]   3.040816   3.000000   2.960784   2.923077   2.886792   2.851852\n [55]   2.818182   2.785714   2.754386   2.724138   2.694915   2.666667\n [61]   2.639344   2.612903   2.587302   2.562500   2.538462   2.515152\n [67]   2.492537   2.470588   2.449275   2.428571   2.408451   2.388889\n [73]   2.369863   2.351351   2.333333   2.315789   2.298701   2.282051\n [79]   2.265823   2.250000   2.234568   2.219512   2.204819   2.190476\n [85]   2.176471   2.162791   2.149425   2.136364   2.123596   2.111111\n [91]   2.098901   2.086957   2.075269   2.063830   2.052632   2.041667\n [97]   2.030928   2.020408   2.010101   2.000000\n\n\n\n\nA.1.3 Strings\n\n#Using strings in R\nmystring &lt;- \"Ecology\"\nvstrg &lt;- c(\"Anna\", \"Peter\", \"Xavier\")\nvstrg[2]\n\n[1] \"Peter\"\n\n\n\n\nA.1.4 Matrices\n\nm &lt;- matrix(5,3,2)\nm\n\n     [,1] [,2]\n[1,]    5    5\n[2,]    5    5\n[3,]    5    5\n\nm2 &lt;- matrix(1:6,3,2)\nm2\n\n     [,1] [,2]\n[1,]    1    4\n[2,]    2    5\n[3,]    3    6\n\nt(m2) # transposes matrix\n\n     [,1] [,2] [,3]\n[1,]    1    2    3\n[2,]    4    5    6\n\nx &lt;- 1:4\ny &lt;- 5:8\n\nm3&lt;-cbind(x,y)\nm3\n\n     x y\n[1,] 1 5\n[2,] 2 6\n[3,] 3 7\n[4,] 4 8\n\nm4&lt;-rbind(x,y)\nm4\n\n  [,1] [,2] [,3] [,4]\nx    1    2    3    4\ny    5    6    7    8\n\n# Indexing matrices\nm3[3,2] #element in row 3 and column 2\n\ny \n7 \n\nm3[1,] #entire first row\n\nx y \n1 5 \n\nm3[,1] #entire first column\n\n[1] 1 2 3 4\n\ncolnames(m3)&lt;-c(\"col1\",\"col2\")\nm3\n\n     col1 col2\n[1,]    1    5\n[2,]    2    6\n[3,]    3    7\n[4,]    4    8\n\nm3[,\"col2\"]\n\n[1] 5 6 7 8\n\n\n\n\nA.1.5 Lists\n\n# Lists in R\nmylist &lt;- list(elem1=m,elem2=v2,elem3=\"my list\")\nmylist$elem2\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100\n\n\n\n\nA.1.6 Dataframes\n\n# Dataframes\ndf &lt;- as.data.frame(m3)\ndf$col1\n\n[1] 1 2 3 4",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#basic-plots-in-r",
    "href": "intro_to_R.html#basic-plots-in-r",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.2 Basic plots in R",
    "text": "A.2 Basic plots in R\n\n#making plots in R\nplot(v2,v2)\n\n\n\n\n\n\n\nplot(v2,v2^2)\n\n\n\n\n\n\n\nplot(v2,v2^2,type=\"l\")\n\n\n\n\n\n\n\nplot(v2,v2^2,type=\"l\",col=\"red\")\n\n\n\n\n\n\n\nplot(v2,v2^2,type=\"l\",col=\"red\",main=\"My beautiful plot\")\n\n\n\n\n\n\n\nplot(v2,v2^2,type=\"l\",col=\"red\",main=\"My beautiful plot\",xlab=\"x\",\n     ylab=\"x^2\")\nlines(v2,v2^3,col=\"blue\")",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#iterations-and-conditional-expressions",
    "href": "intro_to_R.html#iterations-and-conditional-expressions",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.3 Iterations and conditional expressions",
    "text": "A.3 Iterations and conditional expressions\n\n# FOR loops\n\nfor (k in 1:10)  # for k =1, 2, 3, 4, 5,...10\n  print (k^2)   #do this\n\n[1] 1\n[1] 4\n[1] 9\n[1] 16\n[1] 25\n[1] 36\n[1] 49\n[1] 64\n[1] 81\n[1] 100\n\nR &lt;- 1.2\nn &lt;- 1\nprint(n[1])\n\n[1] 1\n\nfor (t in 1:100)\n{\n  n[t+1] &lt;- R*n[t]\n  print(n[t+1])\n}\n\n[1] 1.2\n[1] 1.44\n[1] 1.728\n[1] 2.0736\n[1] 2.48832\n[1] 2.985984\n[1] 3.583181\n[1] 4.299817\n[1] 5.15978\n[1] 6.191736\n[1] 7.430084\n[1] 8.9161\n[1] 10.69932\n[1] 12.83918\n[1] 15.40702\n[1] 18.48843\n[1] 22.18611\n[1] 26.62333\n[1] 31.948\n[1] 38.3376\n[1] 46.00512\n[1] 55.20614\n[1] 66.24737\n[1] 79.49685\n[1] 95.39622\n[1] 114.4755\n[1] 137.3706\n[1] 164.8447\n[1] 197.8136\n[1] 237.3763\n[1] 284.8516\n[1] 341.8219\n[1] 410.1863\n[1] 492.2235\n[1] 590.6682\n[1] 708.8019\n[1] 850.5622\n[1] 1020.675\n[1] 1224.81\n[1] 1469.772\n[1] 1763.726\n[1] 2116.471\n[1] 2539.765\n[1] 3047.718\n[1] 3657.262\n[1] 4388.714\n[1] 5266.457\n[1] 6319.749\n[1] 7583.698\n[1] 9100.438\n[1] 10920.53\n[1] 13104.63\n[1] 15725.56\n[1] 18870.67\n[1] 22644.8\n[1] 27173.76\n[1] 32608.52\n[1] 39130.22\n[1] 46956.26\n[1] 56347.51\n[1] 67617.02\n[1] 81140.42\n[1] 97368.5\n[1] 116842.2\n[1] 140210.6\n[1] 168252.8\n[1] 201903.3\n[1] 242284\n[1] 290740.8\n[1] 348889\n[1] 418666.7\n[1] 502400.1\n[1] 602880.1\n[1] 723456.1\n[1] 868147.4\n[1] 1041777\n[1] 1250132\n[1] 1500159\n[1] 1800190\n[1] 2160228\n[1] 2592274\n[1] 3110729\n[1] 3732875\n[1] 4479450\n[1] 5375340\n[1] 6450408\n[1] 7740489\n[1] 9288587\n[1] 11146304\n[1] 13375565\n[1] 16050678\n[1] 19260814\n[1] 23112977\n[1] 27735572\n[1] 33282687\n[1] 39939224\n[1] 47927069\n[1] 57512482\n[1] 69014979\n[1] 82817975\n\nR &lt;- 1.2\nn &lt;- 1\nfor (t in 1:100)\n  n[t+1] &lt;- R*n[t]\n\n# IF conditional statement\n\n# logical operators\n# == equal to\n# &gt; greater than\n# &lt; smaller than\n# &gt;= greater or equal\n# &lt;= smaller or equal\n# != different from\n# && and\n# || or\n\nif (3&gt;2) print (\"yes\")\n\n[1] \"yes\"\n\nif (3==2) print (\"yes\") else print(\"no\")\n\n[1] \"no\"\n\nif ((3&gt;2)&&(4&gt;5)) print (\"yes\")\n\nfor (k in 1:10)  # for k =1, 2, 3, 4, 5,...10\n  if (k^2&gt;20) print (k^2)  \n\n[1] 25\n[1] 36\n[1] 49\n[1] 64\n[1] 81\n[1] 100",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#writing-functions",
    "href": "intro_to_R.html#writing-functions",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.4 Writing functions",
    "text": "A.4 Writing functions\n\n# creating FUNCTIONS in r\n\npythagoras &lt;- function (c1,c2)\n{\n  h &lt;- sqrt (c1^2 + c2^2)\n  return (h)\n}\n\npythagoras(1,1)\n\n[1] 1.414214\n\npythagoras(5,5)\n\n[1] 7.071068\n\npythagoras(10,1)\n\n[1] 10.04988\n\n# regression in R\n\nhelp(lm)\nx &lt;- c(1,2,3,4)\ny &lt;- c(1.1,2.3,2.9,4.1)\nplot(x,y)\nmyreg&lt;-lm(y ~ x)\nsummary(myreg)\n\n\nCall:\nlm(formula = y ~ x)\n\nResiduals:\n    1     2     3     4 \n-0.06  0.18 -0.18  0.06 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)  0.20000    0.23238   0.861  0.48012   \nx            0.96000    0.08485  11.314  0.00772 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1897 on 2 degrees of freedom\nMultiple R-squared:  0.9846,    Adjusted R-squared:  0.9769 \nF-statistic:   128 on 1 and 2 DF,  p-value: 0.007722\n\nabline(myreg)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#random-numbers-and-statistical-distributions",
    "href": "intro_to_R.html#random-numbers-and-statistical-distributions",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.5 Random numbers and statistical distributions",
    "text": "A.5 Random numbers and statistical distributions\n\nrandom1d&lt;-function(tmax)\n{\nx&lt;-0\nfor (t in 1:tmax)\n{\n  r&lt;-runif(1)\n  if (r&lt;1/2)\n    x[t+1]&lt;-x[t]+1 else\n      x[t+1]&lt;-x[t]-1\n}\nreturn(x)\n}\n\nplot(random1d(100))\n\n\n\n\n\n\n\ntmax&lt;-10000\nlastx&lt;-0\nfor (i in 1:1000)\n{\n  x&lt;-random1d(tmax)\n  lastx[i]&lt;-x[tmax]\n}\n\nhist(lastx)\n\n\n\n\n\n\n\nmean(lastx)\n\n[1] 0.79\n\nd&lt;-sqrt(lastx^2)\nhist(d)\n\n\n\n\n\n\n\nmean(d)\n\n[1] 77.34\n\nmedian(d)\n\n[1] 65\n\nmax(d)\n\n[1] 321\n\nhist(d[d&lt;20],breaks=c(1:20))",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#intro-to-apply-pipes-ggplot2-tidyverse",
    "href": "intro_to_R.html#intro-to-apply-pipes-ggplot2-tidyverse",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.6 Intro to apply, pipes, ggplot2, tidyverse",
    "text": "A.6 Intro to apply, pipes, ggplot2, tidyverse\nUse of apply instead of for loops.\n\n# a recursive function that calculates a factorial\nmyfun &lt;- function(x)\n{\n  if (x==1)\n    return (1)\n  else return(x*myfun(x-1))\n}\n\nThe following does not work\n\nmyfun(1:10) # does not work\n\nOne needs to do a for loop or use apply\n\n#option1 - with a for loop\nstart_time &lt;- Sys.time()\ny&lt;-0\nfor (i in 1:100)\n  y[i]&lt;-myfun(i)\nend_time &lt;- Sys.time()\nend_time-start_time\n\nTime difference of 0.005800009 secs\n\ny\n\n  [1]  1.000000e+00  2.000000e+00  6.000000e+00  2.400000e+01  1.200000e+02\n  [6]  7.200000e+02  5.040000e+03  4.032000e+04  3.628800e+05  3.628800e+06\n [11]  3.991680e+07  4.790016e+08  6.227021e+09  8.717829e+10  1.307674e+12\n [16]  2.092279e+13  3.556874e+14  6.402374e+15  1.216451e+17  2.432902e+18\n [21]  5.109094e+19  1.124001e+21  2.585202e+22  6.204484e+23  1.551121e+25\n [26]  4.032915e+26  1.088887e+28  3.048883e+29  8.841762e+30  2.652529e+32\n [31]  8.222839e+33  2.631308e+35  8.683318e+36  2.952328e+38  1.033315e+40\n [36]  3.719933e+41  1.376375e+43  5.230226e+44  2.039788e+46  8.159153e+47\n [41]  3.345253e+49  1.405006e+51  6.041526e+52  2.658272e+54  1.196222e+56\n [46]  5.502622e+57  2.586232e+59  1.241392e+61  6.082819e+62  3.041409e+64\n [51]  1.551119e+66  8.065818e+67  4.274883e+69  2.308437e+71  1.269640e+73\n [56]  7.109986e+74  4.052692e+76  2.350561e+78  1.386831e+80  8.320987e+81\n [61]  5.075802e+83  3.146997e+85  1.982608e+87  1.268869e+89  8.247651e+90\n [66]  5.443449e+92  3.647111e+94  2.480036e+96  1.711225e+98 1.197857e+100\n [71] 8.504786e+101 6.123446e+103 4.470115e+105 3.307885e+107 2.480914e+109\n [76] 1.885495e+111 1.451831e+113 1.132428e+115 8.946182e+116 7.156946e+118\n [81] 5.797126e+120 4.753643e+122 3.945524e+124 3.314240e+126 2.817104e+128\n [86] 2.422710e+130 2.107757e+132 1.854826e+134 1.650796e+136 1.485716e+138\n [91] 1.352002e+140 1.243841e+142 1.156773e+144 1.087366e+146 1.032998e+148\n [96] 9.916779e+149 9.619276e+151 9.426890e+153 9.332622e+155 9.332622e+157\n\n#option 2 - with apply\nstart_time &lt;- Sys.time()\ny&lt;-sapply(1:100,myfun)\nend_time &lt;- Sys.time()\nend_time-start_time\n\nTime difference of 0.002110004 secs\n\ny\n\n  [1]  1.000000e+00  2.000000e+00  6.000000e+00  2.400000e+01  1.200000e+02\n  [6]  7.200000e+02  5.040000e+03  4.032000e+04  3.628800e+05  3.628800e+06\n [11]  3.991680e+07  4.790016e+08  6.227021e+09  8.717829e+10  1.307674e+12\n [16]  2.092279e+13  3.556874e+14  6.402374e+15  1.216451e+17  2.432902e+18\n [21]  5.109094e+19  1.124001e+21  2.585202e+22  6.204484e+23  1.551121e+25\n [26]  4.032915e+26  1.088887e+28  3.048883e+29  8.841762e+30  2.652529e+32\n [31]  8.222839e+33  2.631308e+35  8.683318e+36  2.952328e+38  1.033315e+40\n [36]  3.719933e+41  1.376375e+43  5.230226e+44  2.039788e+46  8.159153e+47\n [41]  3.345253e+49  1.405006e+51  6.041526e+52  2.658272e+54  1.196222e+56\n [46]  5.502622e+57  2.586232e+59  1.241392e+61  6.082819e+62  3.041409e+64\n [51]  1.551119e+66  8.065818e+67  4.274883e+69  2.308437e+71  1.269640e+73\n [56]  7.109986e+74  4.052692e+76  2.350561e+78  1.386831e+80  8.320987e+81\n [61]  5.075802e+83  3.146997e+85  1.982608e+87  1.268869e+89  8.247651e+90\n [66]  5.443449e+92  3.647111e+94  2.480036e+96  1.711225e+98 1.197857e+100\n [71] 8.504786e+101 6.123446e+103 4.470115e+105 3.307885e+107 2.480914e+109\n [76] 1.885495e+111 1.451831e+113 1.132428e+115 8.946182e+116 7.156946e+118\n [81] 5.797126e+120 4.753643e+122 3.945524e+124 3.314240e+126 2.817104e+128\n [86] 2.422710e+130 2.107757e+132 1.854826e+134 1.650796e+136 1.485716e+138\n [91] 1.352002e+140 1.243841e+142 1.156773e+144 1.087366e+146 1.032998e+148\n [96] 9.916779e+149 9.619276e+151 9.426890e+153 9.332622e+155 9.332622e+157\n\n\nSelecting a subset from a matrix and applying a function to a column of that subset\n\nFlorida &lt;- read.csv(\"Labs/Florida.csv\")\n\n# number of species for year 1970 and route 20\nx=tapply(Florida$Abundance,Florida$Route==20 & Florida$Year==1970, length)\n#applies length() to Florida$Abundance but by two levels, when the formula is true\n#and when the formula is false\n\n# matrix with number of species per route and per year\nout&lt;-tapply(Florida$Abundance,list(Florida$Route,Florida$Year), length)\n\nplot(out[10,])\n\n\n\n\n\n\n\n\n\nshannon&lt;-function(x)\n{\n  p&lt;-x/sum(x)\n  - sum(p*log(p))\n}\n\nout&lt;-tapply(Florida$Abundance,list(Florida$Route,Florida$Year), shannon)\nplot(out[10,])\n\n\n\n\n\n\n\n\n\nA.6.1 Working with pipes\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n#our first pipe\nx&lt;-rnorm(1000)\nhist(x)\n\n\n\n\n\n\n\nrnorm(1000) %&gt;%  hist\n\n\n\n\n\n\n\n\nNow with the Florida data\n\nt&lt;-1:ncol(out)\n\nplot(out[10,])\nmyreg&lt;-lm(out[10,]~t)\nsummary(myreg)\n\n\nCall:\nlm(formula = out[10, ] ~ t)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.289301 -0.062193 -0.007159  0.033154  0.243719 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.5288806  0.0289650  121.83  &lt; 2e-16 ***\nt           -0.0065709  0.0009334   -7.04 4.71e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1039 on 51 degrees of freedom\nMultiple R-squared:  0.4928,    Adjusted R-squared:  0.4829 \nF-statistic: 49.56 on 1 and 51 DF,  p-value: 4.708e-09\n\nabline(myreg)\n\n\n\n\n\n\n\nplot(out[10,])\nlm(out[10,]~t) %&gt;% summary %&gt;%abline\n\nWarning in abline(.): only using the first two of 8 regression coefficients\n\n\n\n\n\n\n\n\n\n\n\nA.6.2 Using dplyr (tidyverse)\nBase R\n\nmtcars\n\n                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nMazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\nValiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1\nDuster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4\nMerc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2\nMerc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2\nMerc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4\nMerc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4\nMerc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3\nMerc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3\nMerc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3\nCadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4\nLincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4\nChrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4\nFiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1\nHonda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2\nToyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1\nToyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1\nDodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2\nAMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2\nCamaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4\nPontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2\nFiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1\nPorsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2\nLotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2\nFord Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4\nFerrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6\nMaserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8\nVolvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2\n\n# 1. Filter rows where mpg &gt; 20\nsubset_data &lt;- mtcars[mtcars$mpg &gt; 20, ]\n\n# 2. Select only mpg, cyl, hp columns\nsubset_data &lt;- subset_data[, c(\"mpg\", \"cyl\", \"hp\")]\n\n# 3. Add new column kpg = mpg * 1.6\nsubset_data$kpg &lt;- subset_data$mpg * 1.6\n\n# 4. Order by descending mpg\nsubset_data &lt;- subset_data[order(-subset_data$mpg), ]\n\nOr\n\nsubset_data &lt;- subset(mtcars, mpg &gt; 20, select = c(mpg, cyl, hp))\nsubset_data &lt;- transform(subset_data, kpg = mpg * 1.6)\nsubset_data &lt;- subset_data[order(-subset_data$mpg), ]\n\nNow with tidyverse\n\nlibrary(dplyr)\n\nmtcars |&gt;\n    filter(mpg &gt; 20) |&gt;\n    dplyr::select(mpg, cyl, hp) |&gt;\n    mutate(kpg = mpg * 1.6) |&gt;arrange(desc(mpg))\n\n                mpg cyl  hp   kpg\nToyota Corolla 33.9   4  65 54.24\nFiat 128       32.4   4  66 51.84\nHonda Civic    30.4   4  52 48.64\nLotus Europa   30.4   4 113 48.64\nFiat X1-9      27.3   4  66 43.68\nPorsche 914-2  26.0   4  91 41.60\nMerc 240D      24.4   4  62 39.04\nDatsun 710     22.8   4  93 36.48\nMerc 230       22.8   4  95 36.48\nToyota Corona  21.5   4  97 34.40\nHornet 4 Drive 21.4   6 110 34.24\nVolvo 142E     21.4   4 109 34.24\nMazda RX4      21.0   6 110 33.60\nMazda RX4 Wag  21.0   6 110 33.60\n\n\nMuch better with\n\npak::pak(\"hadley/genzplyr\")\n\nℹ Loading metadata database\n\n\n✔ Loading metadata database ... done\n\n\n\n\n\n \n\n\nℹ No downloads are needed\n\n\n✔ 1 pkg + 15 deps: kept 16 [5.5s]\n\nlibrary(genzplyr)\n\ngenzplyr loaded fr fr 💅\nYour data wrangling is about to be bussin no cap\n\nmtcars |&gt;\n  yeet(mpg &gt; 20) |&gt;\n  vibe_check(mpg, cyl, hp) |&gt;\n  glow_up(kpg = mpg * 1.6) |&gt;\n  slay(desc(mpg))\n\n                mpg cyl  hp   kpg\nToyota Corolla 33.9   4  65 54.24\nFiat 128       32.4   4  66 51.84\nHonda Civic    30.4   4  52 48.64\nLotus Europa   30.4   4 113 48.64\nFiat X1-9      27.3   4  66 43.68\nPorsche 914-2  26.0   4  91 41.60\nMerc 240D      24.4   4  62 39.04\nDatsun 710     22.8   4  93 36.48\nMerc 230       22.8   4  95 36.48\nToyota Corona  21.5   4  97 34.40\nHornet 4 Drive 21.4   6 110 34.24\nVolvo 142E     21.4   4 109 34.24\nMazda RX4      21.0   6 110 33.60\nMazda RX4 Wag  21.0   6 110 33.60\n\n\n\n# Complete analysis that's absolutely bussin\nmtcars |&gt;\n  yeet(hp &gt; 100) |&gt;                    # Yeet the weak cars\n  vibe_check(mpg, cyl, hp, wt) |&gt;      # Vibe check our columns\n  glow_up(                              # Glow up the data\n    hp_per_ton = hp / (wt / 2),\n    efficiency = mpg / (hp / 100)\n  ) |&gt;\n  squad_up(cyl) |&gt;                     # Squad up by cylinders\n  no_cap(                               # Get the real stats\n    avg_hp = mean(hp),\n    avg_mpg = mean(mpg),\n    avg_efficiency = mean(efficiency),\n    squad_size = n()\n  ) |&gt;\n  disband() |&gt;                         # Disband the squads\n  slay(desc(avg_efficiency)) |&gt;        # Sort by slay factor\n  send_it(10)     \n\n# A tibble: 3 × 5\n    cyl avg_hp avg_mpg avg_efficiency squad_size\n  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;      &lt;int&gt;\n1     4   111     25.9          23.3           2\n2     6   122.    19.7          16.6           7\n3     8   209.    15.1           7.67         14\n\n\n\n\nA.6.3 Introduction to gpplot2\nggplot2 is based on ideas from the book “A grammar of graphics” by Leland Wilkinson and developed by Hadley Wickham, which also developed tidyverse.\n\nlibrary(ggplot2)\n\ncars\n\n   speed dist\n1      4    2\n2      4   10\n3      7    4\n4      7   22\n5      8   16\n6      9   10\n7     10   18\n8     10   26\n9     10   34\n10    11   17\n11    11   28\n12    12   14\n13    12   20\n14    12   24\n15    12   28\n16    13   26\n17    13   34\n18    13   34\n19    13   46\n20    14   26\n21    14   36\n22    14   60\n23    14   80\n24    15   20\n25    15   26\n26    15   54\n27    16   32\n28    16   40\n29    17   32\n30    17   40\n31    17   50\n32    18   42\n33    18   56\n34    18   76\n35    18   84\n36    19   36\n37    19   46\n38    19   68\n39    20   32\n40    20   48\n41    20   52\n42    20   56\n43    20   64\n44    22   66\n45    23   54\n46    24   70\n47    24   92\n48    24   93\n49    24  120\n50    25   85\n\nplot(cars$speed,cars$dist)\n\n\n\n\n\n\n\nggplot(data=cars, mapping=aes(x=speed,y=dist)) + geom_point(colour=\"red\")\n\n\n\n\n\n\n\n\n\nmyplot &lt;-  ggplot(cars, aes(speed,dist))+\n  geom_point()+geom_line()\nmyplot\n\n\n\n\n\n\n\ndata(cars)\nmyplot &lt;-  ggplot(cars, aes(speed,dist))+\n  geom_point()+geom_smooth(method=\"lm\")\nmyplot\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\ndata(cars)\nmyplot &lt;-  ggplot(cars, aes(speed,dist))+\n  geom_point()+geom_smooth(method=\"lm\")+scale_x_log10()+scale_y_log10()\nmyplot\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWith tidyplot\n\nlibrary(tidyplots)\ncars |&gt;  tidyplot(x=speed,y=dist) |&gt;\n  add_data_points_beeswarm() |&gt;\n  add_curve_fit(method=\"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\ncars |&gt;  tidyplot(x=speed,y=dist) |&gt;\n  add_data_points_beeswarm() |&gt;\n  add_curve_fit()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWith the florida data\n\n#ggplot\nmat=cbind(t,out[10,])\ncolnames(mat)&lt;-c(\"time\",\"shannon\")\nmat&lt;-as.data.frame(mat)\n\nmyplot &lt;-  ggplot(mat, aes(time,shannon))+\n  geom_point()\nmyplot\n\n\n\n\n\n\n\nmyplot &lt;-  ggplot(mat, aes(time,shannon))+\n  geom_line()\nmyplot",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#working-with-biodiversity-data-gbif-ebv-portal",
    "href": "intro_to_R.html#working-with-biodiversity-data-gbif-ebv-portal",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.7 Working with biodiversity data: GBIF, EBV Portal",
    "text": "A.7 Working with biodiversity data: GBIF, EBV Portal\nAuthors: Corey Callaghan, Luise Quoss, Isabel Rosa.\nFirst we load the library rgbif\n\nlibrary(rgbif)\nlibrary(tidyverse)\n\nNow we will download observations of a species. Let’s download observations of the common toad Bufo bufo.\n\nmatbufobufo&lt;-occ_search(scientificName=\"Bufo bufo\", limit=500, hasCoordinate = TRUE, hasGeospatialIssue = FALSE)\n\nError in occ_search(scientificName = \"Bufo bufo\", limit = 500, hasCoordinate = TRUE, : could not find function \"occ_search\"\n\n\nLet’s examine the object matbufobufo\n\nclass(matbufobufo)\n\nError: object 'matbufobufo' not found\n\nmatbufobufo\n\nError: object 'matbufobufo' not found\n\n\nIt is a special object of class gbif which allows for the metadata and the actual data to all be included, as well as taxonomic hierarchy data, and media metadata. We won’t worry too much about the details of this object now.\nLet’s download data about octupusses. They are in the order “Octopoda”. First we need to find the GBIF search key for Octopoda.\n\na&lt;-name_suggest(q=\"Octopoda\",rank=\"Order\")\n\nError in name_suggest(q = \"Octopoda\", rank = \"Order\"): could not find function \"name_suggest\"\n\nkey&lt;-a$data$key\n\nError: object 'a' not found\n\n\nWe will only download 2000 observations to keep it simple for now. If you were doing this for real, you would download all data.\n\noctopusses&lt;-occ_search(orderKey=key,limit=2000, hasCoordinate = TRUE, hasGeospatialIssue = FALSE)\n\nError in occ_search(orderKey = key, limit = 2000, hasCoordinate = TRUE, : could not find function \"occ_search\"\n\n\nShow the result\n\noctmat&lt;-octopusses$data\n\nError: object 'octopusses' not found\n\nhead(octmat)\n\nError: object 'octmat' not found\n\n\nCount the number of observations per species using tidyverse and pipes\n\noctmat %&gt;% \n  group_by(scientificName) %&gt;% \n  summarise(sample_size=n()) %&gt;%\n  arrange(desc(sample_size)) %&gt;% \n  mutate(sample_size_log=log(sample_size,2)) %&gt;% \n  ggplot(aes(x = sample_size_log)) + geom_histogram() \n\nError: object 'octmat' not found\n\n\nPlot the records on an interactive map. First load the leaflet package.\n\nlibrary(leaflet)\nleaflet(data=octmat) %&gt;% addTiles() %&gt;%\n  addCircleMarkers(lat= ~decimalLatitude, lng = ~decimalLongitude,popup=~scientificName)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "intro_to_R.html#working-with-raster-and-shapefiles",
    "href": "intro_to_R.html#working-with-raster-and-shapefiles",
    "title": "Appendix A — A brief R tutorial",
    "section": "A.8 Working with raster and shapefiles",
    "text": "A.8 Working with raster and shapefiles",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>A brief R tutorial</span>"
    ]
  },
  {
    "objectID": "labs.html",
    "href": "labs.html",
    "title": "Appendix B — Computational labs",
    "section": "",
    "text": "B.1 Climate space of an ectotherm\nSolar radiation and convection are the two main pathways for animals such as small lizards. In this case, the total heat flux (f) into the animal is given by the heat flux equation:\n\\[f = q\\ –h*(b - a)\\]\nSection 1.4.2 presents a data frame containing data on individuals A. cristatellus living in urban and forested areas in three cities in Puerto Rico, giving us the perfect opportunity to assess the potential thermal effects of habitat upon this species. To do this:\nHint: to filter the data you can use the subset function in R\n# example filtering data from anoles only from San Jose sites\ndf_sanjose &lt;- subset(df, Site == \"San Jose\")",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#climate-space-of-an-ectotherm",
    "href": "labs.html#climate-space-of-an-ectotherm",
    "title": "Appendix B — Computational labs",
    "section": "",
    "text": "\\(q\\) = solar radiation (cal/h)\n\\(h*(b - a)\\) = heat loss through convection\n\\(b\\) = body temperature of the animal (ºC)\n\\(a\\) = air temperature (ºC)\n\\(h\\) = convection heat transfer coefficient (cal/h/ ºC)\n\n\nEquilibrium body temperature\n\nAssuming that air temperature is 18ºC, and h = 50 cal/h, plot the lizard’s equilibrium body temperature as a function of solar radiation. Assume that solar radiation varies between 0 and 1500 cal/h\n\nClimate space of a Lizard\n\nDraw the climate space of the lizard by drawing the polygon that is limited by the minimum and maximum temperatures that the lizard can support, as a function of solar radiation. Consider that the upper lethal limit for the body temperature (bmax) is 36ºC and the lower lethal limit for the body temperature (bmin) is 24ºC.\nHint: polygon - draws the polygons whose vertices are given in x and y.\n\nAir Temperature and solar radiation throughout the day in two locations\n\nPlot the following values of air temperature and solar radiation that are available throughout a day in two locations. For:\n\nTimes of the day\nt = c(\"00:00\",\"03:00\",\"06:00\",\"09:00\",\"12:00\",\n  \"15:00\",\"18:00\",\"21:00\",\"00:00\")\nSolar radiation in the rock habitat\nrock_q = c(150,150,800,1100,1300,1200,800,400,150)\nAir temperature in the rock habitat\nrock_a = c(18,13,10,14,21,24,22,20,18)\nSolar radiation in the bush habitat\nbush_q = c(150,150,450,600,650,650,350,200,150)\nAir temperature in the bush habitat\nbush_a = c(18,13,10,14,21,24,22,20,18)\n\nAt which time of the day is the lizard on the rock, and at which time is it at the bush? Is there any time when the lizard cannot be at any of the locations?\n\nBody temperature of A. cristatellus in two different habitats\n\n\n\nMake a linear model for individuals of A. cristatellus living only in natural habitats (context = natural) and another for individuals living in urban habitats (context = urban).\n\n\n\n\nIs there a habitat where lizards are consistently warmer? If so, provide an ecological explanation (quantitatively) for this observation (assume an ambient temperature of 30 °C).\nIs your model appropriate for explaining your data?",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#optimal-foraging-theory",
    "href": "labs.html#optimal-foraging-theory",
    "title": "Appendix B — Computational labs",
    "section": "B.2 Optimal foraging theory",
    "text": "B.2 Optimal foraging theory\n\nPredator with a strategy for maximizing energy.\nLet ai be the point abundance per unit of time of prey type i, ei be the caloric content of prey type i, hi be the time it takes to consume prey type i, ew is the energy expended per unit of time by the predator while searching for prey, and eh is the energy expended per unit of time by the predator to ingest prey. Consider that there are only two types of prey and that:\nStrategy 1: Chosing prey of type 1\nStrategy 2: Chosing prey of type 2\nStrategy 3: Chosing both preys\n\nShow that if e1&gt; e2 and h1 &lt;h2 then the second strategy is never a optimal strategy\nPlot and comment the graph of the energy gain per unit of time for the strategy of consuming both preys and for the strategy of consuming only the best prey. Make the abundances vary between 0.005 and 0.5 ind/s for the best prey. Consider the abundance of the worse prey to be 0.05 ind/s and 0.01 ind/s. Consider an active predator with the following physiological parameters:\ne1 = 10J; e2 = 100J; h1 = 1s; h2 = 60s; ew = 1 J/s; eh = 1 J/S\n\nPredator with a strategy of sit-and-wait.\nEw is the energy expended per unit of time by the predator while waiting for its prey, ep is the energy expended per unit of time by the predator while chasing the prey, v is the velocity of the predator in chase and a is the point abundance of preys per unit of time.\n\nProduce a graph of energy gain per unit of time in function of the size of the feeding territory. Consider the following values for the parameters of the predator and prey: ew = 0,1 J/s; ep = 1 J/S; v = 0,5 m/s; a = 0,005 ind/s/m2; and e = 10;",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#evolutionary-games",
    "href": "labs.html#evolutionary-games",
    "title": "Appendix B — Computational labs",
    "section": "B.3 Evolutionary games",
    "text": "B.3 Evolutionary games\n\nThe Prisoners Dilemma Competition. In this class we will have a competition of algorithms for playing the prisoner’s dilemma.\n\nWrite a function that takes as parameters two vectors that account with the history of the previous plays and returns one play (i.e., Cooperate – “C” or defect – “D”). This play should try to be the best response to the history of past moves. One example of such a function is:\n\n\n    strat&lt;-function(own,opponent)\n    {\n        n &lt;- length(opponent)\n             if(n==0) \"D\"\n            else\n                if(own[n]==\"D\") opponent[n]\n               else \"C\"\n    }\n\nUse the function pd_sim (see below) to play your strategy with the strategy of the other groups (ask for each group their function(s)) and with itself, in an iterative game with x moves. Compare the results of the cumulative rewards as well as the sequence of moves. Report to the rest of groups the values of the rewards for each of the tournaments. What was the best strategy? What strategies are best responses to themselves?\n\npd_sim&lt;-function(p1_strat,p2_strat,n)\n{\n w1&lt;-0          #accumulated pay-off (fitness) of player 1\n w2&lt;-0          #accumulated pay-offs of player 2\n h1&lt;-NULL       #history of plays of player 1\n h2&lt;-NULL       #history of plays of player 2\n\n for (t in 1:n)            \n   {\n    a1&lt;-p1_strat(h1,h2) \n    a2&lt;-p2_strat(h2,h1) \n    p1&lt;-mat[a1,a2] \n    p2&lt;-mat[a2,a1]         \n    w1&lt;-w1+p1              \n    w2&lt;-w2+p2             \n    h1[t]&lt;-a1                   \nh2[t]&lt;-a2                   }   \n list(w1=w1,w2=w2,h1=h1,h2=h2)\n}",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#dispersal-and-the-random-walk",
    "href": "labs.html#dispersal-and-the-random-walk",
    "title": "Appendix B — Computational labs",
    "section": "B.4 Dispersal and the random-walk",
    "text": "B.4 Dispersal and the random-walk\n\nRandom walk for 1 individual\n\nCreate your own code to simulate an individual random walk. Assume that the starting point is always x,y =(0,0) and the probability of an individual to choose any direction (i.e. left, right, up or down) is the same. It should be a function taking as argument the number of steps and returning a list of two vectors, one with the x positions over time and another with the y positions overtime.\nPlot together the random walks (at least 5000 steps) of a few individuals. \n\nRandom walk for several (n) individuals\n\nCreate your own code to simulate random walks by several (n)individuals and returns the last position of each individual. It should be a function that takes as arguments the number of individuals and the numbers of time steps, and returns a list of two vectors, the last x position of each individual, and the last y position of each individual.\nCreate a histogram showing the distribution of the x and y last positions of 10 000 individuals after 10 time steps, 100 time steps and 1 000 time steps.\nCreate a function that receives as parameters a vector of values xlast, a mean value (meanx) and a standard deviation (stdx) and returns the log-likelihood of observing those values for those parameters.\nFind the value meanx and stdx that maximize the likelihood of the observations. Are they the same as mean(xlast) and std(xlast)? Why?\nExtra credit: Create a histogram showing the distribution of the distance to the origin (sqrt(x^+y^2)) of the last positions of 10 000 individuals for 10 time steps, 100 time steps, 1000 time steps and 10000 time steps. What is the relationship between the length of the randomwalk and the mean distance? Fit the Rayleigh distribution (2 r / sigma^2) * exp(-r^2/2 sigma^2) using non-linear fitting to each of the histograms and overlay it on the graph.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#pandemic-growth",
    "href": "labs.html#pandemic-growth",
    "title": "Appendix B — Computational labs",
    "section": "B.5 Pandemic growth",
    "text": "B.5 Pandemic growth\n\nThe exponential dynamics of the pandemic. In early 2020, the first wave of the global pandemic of COVID-19 hit several European countries. Here we will plot the data for those countries and fit an exponential growth model.\n\nLoad the cumulative infected individuals time series from the COVID-19 pandemic in five countries. Each time series starts after the first fifteen infections are detected.1\n\nit &lt;- c(17, 79, 132, 229, 322, 400, 650, 888, 1128, 1689, 2036, 2502, \n3089, 3858, 4636, 5883, 7375, 9172, 10149, 12462, 15113, 17660, 21157,\n23980, 27980, 31506, 35713, 41035, 47021, 53578) #Feb22-March22\n\nes &lt;- c(17, 35, 54, 82, 136, 192, 267, 348, 531, 764, 1094, 1527, 2299,\n3274, 4427, 5958, 7641, 9785, 11491, 13994, 17688, 21735, 26304, 31750,\n36616, 41262, 48953, 57506, 66460, 75641) #Feb27-March27\n\nfr &lt;- c(17, 38, 57, 100, 130, 178, 212, 285, 423, 613, 716, 1126, 1412,\n1784, 2281, 2876, 3661, 4499, 5423, 6633, 7730, 9134, 10995, 12612, 14459, \n16018, 19856, 22302, 25233, 29155) #Feb27-March27\n\nuk &lt;- c(18, 22, 30, 42, 47, 69, 109, 164, 220, 271, 352, 412, 469, 617, \n876, 1282, 1766, 2244, 2605, 3047, 3658, 4427, 5426, 6481, 7736, 8934, \n10312, 12650, 15025, 17717) #Feb27-March27\n\nde &lt;- c(17, 21, 47, 57, 111, 129, 157, 196, 262, 400, 684, 847, 902, 1139, \n1296, 1567, 2369, 3062, 3795, 4838, 6012, 7156, 8198, 14138, 18187, 21463, \n24774, 29212, 31554, 36508) #Feb26-March26\n\nPlot the data in a linear plot, coloring each country with a different colour. What do you observe?\nPlot the data in a semi-log plot (using the plot option log=”y”), coloring each country with a different color. What do you observe?\nCarry out a linear regression with the data of each country (using the log of the n values) and estimate the growth rate R. Are the values the same for all countries? Do they vary over time?\nKnowing that \\[R_0 = R^\\tau\\] and that the infectious period (\\(\\tau\\)) duration is 10 days, what are the \\(R_0\\)’s in different countries?\nWrite a for loop to simulate geometric (exponential) growth, going from time t in 1:100, and storing the population size values at each time step t+1 in variable n based on the population values at time t, i.e. n[t+1]&lt;-R*n[t]. Don’t forget to initialize the population size before the for loop with n&lt;-1. Plot a couple of runs of the for loop with different R values (for instance R=1.01 and R=1.1) in linear scale.\nGiven that you know the solution of the geometric growth equation to be \\(n(t)=n_0 R^t\\), create a vector of values with this formula using the same R as you used above, but starting with n0&lt;-2 and overlay them on the plot.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#population-viability-analysis",
    "href": "labs.html#population-viability-analysis",
    "title": "Appendix B — Computational labs",
    "section": "B.6 Population Viability Analysis",
    "text": "B.6 Population Viability Analysis\n\n\nConsider a population with exponential growth but that exhibits environmental stochasticity, with the logarithm of the population growth rate following a normal distribution with mean \\(\\bar{r}=\\log(\\bar{R})\\) and variance \\(v\\). Assume that the population has an on-off density dependence and cannot grow above the carrying capacity \\(K\\). According to Foley (1994)2 the expect time to extinction is \\[T=\\frac{1}{s r}[e^{s \\log(k)}(1-e^{-s \\log(N_0)} )-s \\log(N_0)]\\] where \\(s=2r/v\\).\n\nPlot the mean extinction times, \\(T\\), as a function of \\(r\\), \\(v\\), \\(n_0\\), and \\(K\\). Please comment each plot. \\(r\\) can carry from 0.01 to 0.2, \\(v\\) can vary from 0.05 to 1.0, \\(n0\\) can vary from 0 to 10, and \\(K\\) can vary from 10 to 500. Use as base parameters n0=10, K=100, v=0.3 and r=0.01.\nWrite a function that simulates a population with these dynamics numerically. Start by using the for loop that you developed in Lab 2 and modify it to include a carrying capacity and growth rate that is taken every year from a normal distribution. The function should take parameter n0, r, v, and K. It should return the vector of the population sizes over time.\nSimulate the dynamics with the following parameters:\n\nn0=3; r=0.01; v=0.2; K=500\nn0=100; r=0.01; v=0.2; K=500;\n\nExtended credit: Compare the model predictions with the results from the analytical approximation of Foley. You need to do many simulations to reach the predicted extinction times from Foley. For instance, you can create a function that call the function developed in (b) and executes it 100 times, returning the median time to extinction across the simulations.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#the-camera-trapper",
    "href": "labs.html#the-camera-trapper",
    "title": "Appendix B — Computational labs",
    "section": "B.7 The camera trapper",
    "text": "B.7 The camera trapper\nA researcher place camera traps at a grid of sites during 19 days to observe roe-deer.\n\nLoad the data on the file roe_deer_2016_r.csv into R. Briefly describe the structure of the dataset.\nCase 1: Ignoring detection probability.\n\nBuild a vector that for each site takes value 1 when roe-deer is present and 0 when is absent.\nUsing maximum-likelihood estimate the occupancy probability (\\(\\psi\\)). First create a function that takes as parameters psi and a vector of presence/absences and returns the likelihood. Then plot that function for a range of \\(\\Psi\\) values and find the \\(\\psi\\) value that maximizes the function.\nAssume that based on previous work we know that occupancy is somewhat between 0.2 and 0.5. Using a Bayesian approach, calculate the posterior probability distribution for the occupancy \\(P(\\psi)\\).\n\nHelp: A function returning the \\(P(\\psi|data)\\) . It takes as parameters a vector y of presences/absences, a value for psi, and a function for the prior distribution of \\(\\psi\\) named priorpsi:\noccupancybayesian &lt;- function(y,psi,priorpsi)\n{\n  integrand &lt;- function(x)\n      occupancylikelihood(y,x)*priorpsi(x)\n  occupancylikelihood(y,psi)*priorpsi(psi)/\n      integrate(integrand, lower = 0.01, upper = 0.99)$value\n}\nA function returning \\(P(\\psi)\\), the prior distribution of \\(\\psi\\) values. It takes as parameters a value for psi.\nprior &lt;- function(psi) \n{ \n  dunif(psi,0.2,0.5) \n}\nCase 2: Using a hierarchical model with detection probability\n\nUsing maximum-likelihood estimate the occupancy probability (\\(\\Psi\\)) and detection probability (\\(p\\)).",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#managing-a-fishery",
    "href": "labs.html#managing-a-fishery",
    "title": "Appendix B — Computational labs",
    "section": "B.8 Managing a fishery",
    "text": "B.8 Managing a fishery\n\nConsider that you are managing a fishery with the following dynamics: \\[dn/dt = 0.2 n (1-n/10000) \\]\n\nPlot the production function of the fishery, indicating the stock size for the maximum sustainable yield and the corresponding production level.\nSuppose you establish an annual quota (harvest) that is equivalent to 50% of the maximum sustainable yield. What are the two stock size levels that sustainably allow that exploitation level?\nExplore what happen when you manage this fishery for 100 years. Start by writing a function that simulates the logistic growth above with a constant harvest. The function should take as parameters the initial population size n0 (the stock of the fishery), the annual harvest h, and the number of years for which you simulate the population dynamics and return a vector with the population sizes over time. Discuss the results of the following experiments.\n\nExperiment 1: Set the harvest equal to the production at MSY and initial population size at carrying capacity.\nExperiment 2. Set the harvest equal to the production at MSY and initial population size at the stock size of MSY\nExperiment 3. Set the harvest equal to 50% of the maximum sustainable yield and initial population size at carrying capacity.\nExperiment 4. Set the harvest equal to the production at MSY and initial population size at the stock size of MSY - 1000 individuals.\nExperiment 5. Set the harvest equal to the production at MSY and initial population size at the stock size of MSY - 1000 individuals.\n\nExplain why in a system with constant quotas, MSY is not stable and should not be the management goal.\nExtra credit: Modify the logistic growth function to have stochastic dynamics so that there is a variance of 10% in the annual productivity. Simulate again experiment 2 a few times. What happens?\nDiscuss how these results relate with the paper of Worm et al (2009) about the need to rebuild fisheries.\n\n\n\n\n\nAtlantic cod (Gadus morhua). Source: Hans-Petter Fjeld, CC-BY-SA, Wikipedia.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#road-kill",
    "href": "labs.html#road-kill",
    "title": "Appendix B — Computational labs",
    "section": "B.9 Road Kill",
    "text": "B.9 Road Kill\nPopulations in space and the impacts of roads\n\n\n\n\n\n\n\nThe Red fox\n…So, while they may be most active at night.\nRed foxes are especially active during the\ndaytime in spring and summer (April-Sept)\nas they are foraging for food to feed their young.\nSource photo: Wikipedia, CC0.\n\n\n\n\nGoals of the exercise:\n\nIdentify road segments with hotspots of red fox-car-collisions.\nWhat impact do activity patterns have on the rate of animal-car-collision hotspots?\nUse the False Discovery Rate (FDR) method to identify such hotspots.\n\n\nPlease install the following R packages\n\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(fuzzySim)\nlibrary(grid)\n\nLoad the roadkill dataset.\nExplain the structure of the dataset.\nShow that differences in seasonal activity patterns impact the FDR hotspot results in red fox-car-collisions.\nHow many hotspots were detected for the active season?\nPlot, based on the FDR method, true and “false” hotspots. Explain the general geographic locations of the hotspots and those vary between the two different seasons.\nThink about conservation management implications.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#simulating-a-neutral-community",
    "href": "labs.html#simulating-a-neutral-community",
    "title": "Appendix B — Computational labs",
    "section": "B.10 Simulating a neutral community",
    "text": "B.10 Simulating a neutral community\n\nThe neutral theory in ecology provides a mechanistic explanation for species abundance distributions. It seeks to understand the impact of speciation, extinction, dispersal and ecological drift on the species abundance distribution (SAD), assuming that all species have equal opportunities (Hubbell, 2001).\nIt is important to note that the neutral theory is a model created to explain a pattern of relative abundance within communities, but it does not necessarily reflect reality (communities’ mechanisms). The neutral theory utilizes a model based on the dynamics of a species’ population, which is governed by generalized birth and death events, including speciation, immigration, and emigration (Rosindell et al (2011).\n\n\n\nDiagram of the dynamics of communities in the neutral theory of biodiversity (from Rosindell et al 2011).\n\n\nThe neutral theory paradox is that in absence of migration or mutation diversity gradually declines to zero or monodominance. Let’s see what happens to species richness and the species abundance distribution over time for different parameters of the model. Start by installing the package untb.\n\nWithout mutation or dispersal (pure ecological drift): We start with a local community with 20 species, each with 25 individuals. The simulation then runs for 2500 generations where 10 individuals die per generation. Mutation rate is zero and immigration rate is zero\n\nPlot the number of species over time.\nPlot the species abundance distribution at time 1, 100 and 2500\nPlot the map of individuals at those time steps.\n\nWith point mutation: Same parameters as (1) but with speciation rate of 0.1.\n\nPlot the number of species over time.\nPlot the species abundance distribution at time 1, 100 and 2500\nPlot the map of individuals at those time steps.\n\n[Extra Credit] With immigration: Same parameters as (1) but immigration rate greater than zero. Play with different abundance distributions for the metacommunity.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#monitoring-biodiversity",
    "href": "labs.html#monitoring-biodiversity",
    "title": "Appendix B — Computational labs",
    "section": "B.11 Monitoring biodiversity",
    "text": "B.11 Monitoring biodiversity\n\nExploring the BBS dataset\n\nLoad the file Florida.csv into R. Briefly describe the structure of the dataset.\nMap the monitored transects/routes in Florida’s map. Use the maps library to plot the counties of florida as a base map.\nFor transect 4 and transect 109 in year 2018 plot calculate the species richness, Shannon diversity index H and evenness J of both transects, with H being \\[H=-\\sum_i (p_i \\ln p_i)\\] where \\(p_i\\) is defined as the proportion of individuals found in species \\(i\\). Compare the two transects.\nPlot the species abundance distribution and abundance-rank for both transects. What do you observe?\nChoose one transect and plot the species richness, Shannon diversity, and geometric mean abundance over time\nExtra credit 1: Produce a map of the trends of one these metrics across Florida (for instance coloring different points according to the trend)\nExtra credit 2: Estimate the number of species in Florida by combining the different transects and using one of the estimators. Use bootstrap and/or jacknife to calculate confidence intervals.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  },
  {
    "objectID": "labs.html#footnotes",
    "href": "labs.html#footnotes",
    "title": "Appendix B — Computational labs",
    "section": "",
    "text": "Data source: https://github.com/owid/covid-19-data/tree/master/public/data, accessed 8 Nov 2020↩︎\nFoley, P. (1994) Predicting Extinction Times from Environmental Stochasticity and Carrying-Capacity. Conservation Biology 8: 124–137.↩︎",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Computational labs</span>"
    ]
  }
]